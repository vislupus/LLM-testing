<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows 11 Desktop</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            overflow: hidden;
            height: 100vh;
            position: relative;
        }

        /* Windows 11 Bloom Wallpaper */
        #desktop {
            width: 100%;
            height: 100vh;
            background: 
                radial-gradient(ellipse at 15% 25%, rgba(147, 51, 234, 0.35) 0%, transparent 50%),
                radial-gradient(ellipse at 85% 30%, rgba(59, 130, 246, 0.4) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 85%, rgba(139, 92, 246, 0.3) 0%, transparent 50%),
                radial-gradient(ellipse at 25% 75%, rgba(99, 102, 241, 0.35) 0%, transparent 45%),
                radial-gradient(ellipse at 75% 80%, rgba(236, 72, 153, 0.25) 0%, transparent 40%),
                linear-gradient(180deg, #0a0a1a 0%, #1a1a3e 30%, #0d0d2b 60%, #1a1a4a 100%);
            position: relative;
            overflow: hidden;
        }

        #desktop::before {
            content: '';
            position: absolute;
            top: -100%;
            left: -100%;
            width: 400%;
            height: 400%;
            background: 
                radial-gradient(circle at 30% 40%, rgba(147, 51, 234, 0.15) 0%, transparent 30%),
                radial-gradient(circle at 70% 60%, rgba(59, 130, 246, 0.15) 0%, transparent 30%),
                radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.02) 0%, transparent 50%);
            animation: bloomShift 30s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes bloomShift {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(-2%, -2%) scale(1.02); }
            50% { transform: translate(2%, 1%) scale(0.98); }
            75% { transform: translate(-1%, 2%) scale(1.01); }
        }

        /* Desktop Icons */
        .desktop-icon {
            position: absolute;
            width: 76px;
            text-align: center;
            color: white;
            cursor: pointer;
            border-radius: 4px;
            padding: 6px;
            transition: background 0.15s ease;
        }

        .desktop-icon:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .desktop-icon.selected {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .icon-img {
            width: 44px;
            height: 44px;
            margin: 0 auto 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-text {
            font-size: 11px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
            word-wrap: break-word;
            line-height: 1.3;
        }

        /* Taskbar */
        #taskbar {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            height: 48px;
            background: rgba(32, 32, 32, 0.85);
            backdrop-filter: blur(30px) saturate(150%);
            -webkit-backdrop-filter: blur(30px) saturate(150%);
            border-radius: 8px 8px 0 0;
            display: flex;
            align-items: center;
            padding: 0 12px;
            gap: 6px;
            box-shadow: 
                0 -2px 20px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
            z-index: 10000;
            border-top: 1px solid rgba(255, 255, 255, 0.06);
        }

        .taskbar-icon {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.15s ease;
            position: relative;
        }

        .taskbar-icon:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .taskbar-icon.active::after {
            content: '';
            position: absolute;
            bottom: 3px;
            width: 14px;
            height: 3px;
            background: #60a5fa;
            border-radius: 2px;
            box-shadow: 0 0 8px rgba(96, 165, 250, 0.6);
        }

        .taskbar-icon svg {
            width: 22px;
            height: 22px;
        }

        .taskbar-divider {
            width: 1px;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            margin: 0 6px;
        }

        #clock {
            color: white;
            font-size: 12px;
            text-align: center;
            padding: 0 8px;
            cursor: default;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        #clock .time {
            font-weight: 600;
            font-size: 12px;
        }

        #clock .date {
            font-size: 11px;
            opacity: 0.75;
        }

        /* Windows */
        .window {
            position: absolute;
            background: rgba(32, 32, 32, 0.95);
            backdrop-filter: blur(30px) saturate(150%);
            -webkit-backdrop-filter: blur(30px) saturate(150%);
            border-radius: 8px;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.08);
            min-width: 320px;
            min-height: 220px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: windowOpen 0.2s ease-out;
        }

        @keyframes windowOpen {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .window.maximized {
            width: 100% !important;
            height: calc(100% - 48px) !important;
            top: 0 !important;
            left: 0 !important;
            border-radius: 0;
        }

        .title-bar {
            height: 36px;
            background: rgba(255, 255, 255, 0.03);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 8px 0 12px;
            cursor: move;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .window-title {
            color: white;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }

        .window-title svg {
            width: 16px;
            height: 16px;
        }

        .window-controls {
            display: flex;
            gap: 2px;
        }

        .win-btn {
            width: 32px;
            height: 28px;
            border: none;
            background: transparent;
            color: white;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            transition: all 0.1s ease;
        }

        .win-btn:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .win-btn.close:hover {
            background: #e81123;
        }

        .window-content {
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        /* App Specific Styles */
        /* Notepad */
        .notepad-textarea {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            padding: 10px 14px;
            font-family: 'Consolas', 'Cascadia Code', 'Segoe UI Mono', monospace;
            font-size: 14px;
            resize: none;
            background: #1e1e1e;
            color: #d4d4d4;
            line-height: 1.5;
        }

        .notepad-textarea::selection {
            background: #264f78;
        }

        /* Calculator */
        .calc-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            background: #202020;
        }

        .calc-display {
            background: transparent;
            padding: 20px 24px 10px;
            text-align: right;
        }

        .calc-expression {
            font-size: 14px;
            color: #a0a0a0;
            height: 20px;
            margin-bottom: 4px;
            font-family: 'Segoe UI', sans-serif;
        }

        .calc-result {
            font-size: 40px;
            font-weight: 300;
            color: white;
            line-height: 1;
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background: #000;
            padding: 1px;
            flex: 1;
        }

        .calc-btn {
            border: none;
            background: #303030;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.1s;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .calc-btn:hover {
            background: #3d3d3d;
        }

        .calc-btn:active {
            background: #4d4d4d;
        }

        .calc-btn.operator {
            background: #2d2d2d;
            color: #60a5fa;
        }

        .calc-btn.operator:hover {
            background: #3d3d3d;
        }

        .calc-btn.equals {
            background: #60a5fa;
            color: white;
            font-weight: 500;
        }

        .calc-btn.equals:hover {
            background: #3b82f6;
        }

        /* Paint */
        .paint-toolbar {
            background: #2d2d2d;
            padding: 8px 12px;
            display: flex;
            gap: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            align-items: center;
            flex-wrap: wrap;
        }

        .paint-tool-section {
            display: flex;
            align-items: center;
            gap: 6px;
            padding-right: 12px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .paint-tool-section:last-child {
            border-right: none;
        }

        .color-btn {
            width: 22px;
            height: 22px;
            border: 2px solid transparent;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .color-btn:hover {
            transform: scale(1.15);
        }

        .color-btn.active {
            border-color: white;
            box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.5);
        }

        .tool-btn {
            width: 28px;
            height: 28px;
            border: none;
            background: transparent;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ccc;
        }

        .tool-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .tool-btn.active {
            background: rgba(255, 255, 255, 0.15);
            color: #60a5fa;
        }

        .size-slider {
            width: 80px;
            height: 4px;
            -webkit-appearance: none;
            background: #444;
            border-radius: 2px;
            outline: none;
        }

        .size-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            background: #60a5fa;
            border-radius: 50%;
            cursor: pointer;
        }

        .paint-canvas-container {
            flex: 1;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .paint-canvas {
            cursor: crosshair;
            background: white;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        /* Word */
        .word-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            background: #f3f3f3;
        }

        .word-toolbar {
            background: #2b579a;
            padding: 6px 12px;
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
            align-items: center;
            border-bottom: 1px solid #1e4578;
        }

        .toolbar-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: background 0.1s;
        }

        .toolbar-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .toolbar-divider {
            width: 1px;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            margin: 0 6px;
        }

        .word-editor {
            flex: 1;
            overflow: auto;
            padding: 24px;
            background: #e5e5e5;
        }

        .word-page {
            background: white;
            width: 100%;
            max-width: 816px;
            min-height: 1056px;
            margin: 0 auto;
            padding: 72px 72px;
            box-shadow: 
                0 0 0 1px rgba(0, 0, 0, 0.05),
                0 4px 24px rgba(0, 0, 0, 0.08);
            outline: none;
            font-family: 'Calibri', 'Segoe UI', sans-serif;
            font-size: 11pt;
            line-height: 1.5;
            color: #000;
        }

        .word-page p {
            margin-bottom: 12pt;
        }

        /* File Explorer */
        .explorer-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            background: #202020;
        }

        .explorer-toolbar {
            background: #2d2d2d;
            padding: 6px 12px;
            display: flex;
            gap: 8px;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .explorer-nav-btn {
            width: 28px;
            height: 28px;
            border: none;
            background: transparent;
            color: #888;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .explorer-nav-btn:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .explorer-nav-btn:disabled {
            opacity: 0.4;
            cursor: default;
        }

        .explorer-path {
            flex: 1;
            background: #1e1e1e;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .explorer-body {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .explorer-sidebar {
            width: 200px;
            background: #1e1e1e;
            border-right: 1px solid rgba(255, 255, 255, 0.08);
            padding: 8px;
            color: white;
            font-size: 12px;
            overflow-y: auto;
        }

        .explorer-sidebar-item {
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 2px;
            opacity: 0.85;
        }

        .explorer-sidebar-item:hover {
            background: rgba(255, 255, 255, 0.08);
            opacity: 1;
        }

        .explorer-sidebar-item.active {
            background: rgba(255, 255, 255, 0.12);
            opacity: 1;
        }

        .explorer-main {
            flex: 1;
            background: #202020;
            padding: 12px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            gap: 8px;
            align-content: start;
            overflow-y: auto;
        }

        .file-item {
            text-align: center;
            color: white;
            cursor: pointer;
            padding: 10px 8px;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .file-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .file-item.selected {
            background: rgba(255, 255, 255, 0.12);
        }

        .file-icon {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .file-name {
            font-size: 11px;
            word-break: break-word;
            line-height: 1.3;
            max-width: 100%;
        }

        /* Chrome */
        .chrome-container {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .chrome-toolbar {
            background: #2d2d2d;
            padding: 8px 10px;
            display: flex;
            gap: 8px;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chrome-nav {
            display: flex;
            gap: 4px;
        }

        .chrome-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            color: #888;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
        }

        .chrome-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .chrome-nav-btns {
            display: flex;
            gap: 4px;
        }

        .chrome-address-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            background: #1e1e1e;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 0 12px;
        }

        .chrome-secure {
            color: #4ade80;
            margin-right: 8px;
            display: flex;
            align-items: center;
        }

        .chrome-address {
            flex: 1;
            background: transparent;
            border: none;
            color: white;
            padding: 8px 0;
            font-size: 13px;
            outline: none;
        }

        .chrome-more {
            color: #888;
            cursor: pointer;
            padding: 4px;
        }

        .chrome-frame {
            flex: 1;
            border: none;
            background: white;
        }

        /* Start Menu */
        #start-menu {
            position: fixed;
            bottom: 58px;
            left: 50%;
            transform: translateX(-50%);
            width: 640px;
            height: 680px;
            max-height: calc(100vh - 100px);
            background: rgba(32, 32, 32, 0.92);
            backdrop-filter: blur(30px) saturate(150%);
            -webkit-backdrop-filter: blur(30px) saturate(150%);
            border-radius: 12px;
            box-shadow: 
                0 10px 50px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.08);
            display: none;
            flex-direction: column;
            padding: 24px 32px;
            z-index: 9999;
            animation: startMenuOpen 0.2s ease-out;
        }

        @keyframes startMenuOpen {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0) scale(1);
            }
        }

        #start-menu.active {
            display: flex;
        }

        .start-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .start-title {
            color: white;
            font-size: 14px;
            font-weight: 600;
        }

        .start-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 4px;
            transition: background 0.15s;
        }

        .start-profile:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .profile-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, #60a5fa, #a78bfa);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }

        .start-section-title {
            color: white;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .start-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-bottom: 24px;
        }

        .start-item {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.04);
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 11px;
            gap: 8px;
            cursor: pointer;
            transition: all 0.15s;
        }

        .start-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .start-item svg {
            width: 28px;
            height: 28px;
        }

        .start-recommended {
            flex: 1;
            overflow-y: auto;
        }

        .recommended-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .recommended-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            color: white;
            transition: background 0.15s;
        }

        .recommended-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .recommended-icon {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .recommended-info {
            flex: 1;
        }

        .recommended-name {
            font-size: 12px;
            margin-bottom: 2px;
        }

        .recommended-time {
            font-size: 10px;
            opacity: 0.6;
        }

        .start-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            margin-top: 16px;
        }

        .power-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.15s;
        }

        .power-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Context Menu */
        #context-menu {
            position: fixed;
            background: rgba(44, 44, 44, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 8px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
            padding: 4px;
            min-width: 200px;
            display: none;
            z-index: 100000;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .context-item {
            padding: 8px 16px;
            color: white;
            font-size: 12px;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .context-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .context-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 4px 0;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div id="desktop">
        <!-- Desktop Icons -->
        <div class="desktop-icon" style="top: 16px; left: 16px;" ondblclick="openApp('word')" oncontextmenu="showDesktopContext(event)">
            <div class="icon-img">
                <svg width="44" height="44" viewBox="0 0 48 48">
                    <defs>
                        <linearGradient id="wordGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#2b579a"/>
                            <stop offset="100%" style="stop-color:#1e3d6b"/>
                        </linearGradient>
                    </defs>
                    <rect width="48" height="48" rx="6" fill="url(#wordGrad)"/>
                    <text x="24" y="33" fill="white" font-size="26" font-weight="bold" font-family="Arial" text-anchor="middle">W</text>
                </svg>
            </div>
            <div class="icon-text">Word</div>
        </div>

        <div class="desktop-icon" style="top: 96px; left: 16px;" ondblclick="openApp('paint')" oncontextmenu="showDesktopContext(event)">
            <div class="icon-img">
                <svg width="44" height="44" viewBox="0 0 48 48">
                    <rect width="48" height="48" rx="6" fill="#1a1a1a"/>
                    <circle cx="14" cy="14" r="5" fill="#ff5f57"/>
                    <circle cx="34" cy="14" r="5" fill="#28c840"/>
                    <circle cx="14" cy="34" r="5" fill="#ffbd2e"/>
                    <circle cx="34" cy="34" r="5" fill="#007aff"/>
                </svg>
            </div>
            <div class="icon-text">Paint</div>
        </div>

        <div class="desktop-icon" style="top: 176px; left: 16px;" ondblclick="openApp('calculator')" oncontextmenu="showDesktopContext(event)">
            <div class="icon-img">
                <svg width="44" height="44" viewBox="0 0 48 48">
                    <rect width="48" height="48" rx="6" fill="#202020"/>
                    <rect x="8" y="6" width="32" height="8" rx="2" fill="#3b82f6"/>
                    <text x="12" y="35" fill="#60a5fa" font-size="14" font-family="Arial">÷</text>
                    <text x="30" y="35" fill="#60a5fa" font-size="14" font-family="Arial">×</text>
                    <text x="12" y="44" fill="#60a5fa" font-size="14" font-family="Arial">-</text>
                    <text x="30" y="44" fill="#60a5fa" font-size="14" font-family="Arial">+</text>
                </svg>
            </div>
            <div class="icon-text">Calculator</div>
        </div>

        <div class="desktop-icon" style="top: 256px; left: 16px;" ondblclick="openApp('notepad')" oncontextmenu="showDesktopContext(event)">
            <div class="icon-img">
                <svg width="44" height="44" viewBox="0 0 48 48">
                    <rect width="48" height="48" rx="6" fill="#f5f5f5"/>
                    <rect x="8" y="8" width="32" height="32" rx="3" fill="white" stroke="#ddd" stroke-width="1"/>
                    <line x1="14" y1="18" x2="34" y2="18" stroke="#999" stroke-width="2"/>
                    <line x1="14" y1="26" x2="34" y2="26" stroke="#999" stroke-width="2"/>
                    <line x1="14" y1="34" x2="26" y2="34" stroke="#999" stroke-width="2"/>
                </svg>
            </div>
            <div class="icon-text">Notepad</div>
        </div>

        <div class="desktop-icon" style="top: 336px; left: 16px;" ondblclick="openApp('explorer')" oncontextmenu="showDesktopContext(event)">
            <div class="icon-img">
                <svg width="44" height="44" viewBox="0 0 48 48">
                    <rect x="4" y="10" width="24" height="28" rx="2" fill="#f0c33c"/>
                    <rect x="20" y="6" width="24" height="32" rx="2" fill="#f0c33c"/>
                    <rect x="24" y="14" width="16" height="6" rx="1" fill="#d4a80c"/>
                    <rect x="26" y="6" width="14" height="4" rx="1" fill="#d4a80c"/>
                </svg>
            </div>
            <div class="icon-text">File Explorer</div>
        </div>

        <div class="desktop-icon" style="top: 416px; left: 16px;" ondblclick="openApp('chrome')" oncontextmenu="showDesktopContext(event)">
            <div class="icon-img">
                <svg width="44" height="44" viewBox="0 0 48 48">
                    <defs>
                        <linearGradient id="chromeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#4285f4"/>
                            <stop offset="100%" style="stop-color:#2962cc"/>
                        </linearGradient>
                    </defs>
                    <circle cx="24" cy="24" r="20" fill="url(#chromeGrad)"/>
                    <circle cx="24" cy="24" r="7" fill="white"/>
                    <path d="M24 8c5.5 0 10 4.5 10 8l-10 6-10-6c0-3.5 4.5-8 10-8z" fill="#ea4335"/>
                    <path d="M10 32c-1.8-2.7-2.7-6-2.7-9.5 0-3.5.9-6.8 2.7-9.5l10 6.5-10 12.5z" fill="#fbbc05"/>
                    <path d="M38 32c3-4.5 4.7-10 4.7-16 0-6-1.7-11.5-4.7-16l-10 8 10 12 10-8z" fill="#34a853"/>
                </svg>
            </div>
            <div class="icon-text">Chrome</div>
        </div>
    </div>

    <!-- Taskbar -->
    <div id="taskbar">
        <div class="taskbar-icon" onclick="toggleStart()" title="Start">
            <svg viewBox="0 0 24 24" fill="white">
                <rect x="0" y="0" width="10.5" height="10.5" rx="1"/>
                <rect x="13.5" y="0" width="10.5" height="10.5" rx="1"/>
                <rect x="0" y="13.5" width="10.5" height="10.5" rx="1"/>
                <rect x="13.5" y="13.5" width="10.5" height="10.5" rx="1"/>
            </svg>
        </div>
        
        <div class="taskbar-icon" onclick="openApp('explorer')" title="File Explorer">
            <svg viewBox="0 0 24 24" fill="#f0c33c">
                <path d="M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"/>
            </svg>
        </div>

        <div class="taskbar-icon" onclick="openApp('chrome')" title="Chrome">
            <svg viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" fill="#4285f4"/>
                <circle cx="12" cy="12" r="4" fill="white"/>
            </svg>
        </div>

        <div class="taskbar-icon" onclick="openApp('word')" title="Word">
            <svg viewBox="0 0 24 24">
                <rect width="24" height="24" rx="3" fill="#2b579a"/>
                <text x="12" y="17" fill="white" font-size="14" font-weight="bold" font-family="Arial" text-anchor="middle">W</text>
            </svg>
        </div>

        <div class="taskbar-divider"></div>

        <div id="clock">
            <div class="time" id="time">12:00 PM</div>
            <div class="date" id="date">1/1/2025</div>
        </div>
    </div>

    <!-- Start Menu -->
    <div id="start-menu">
        <div class="start-header">
            <div class="start-title">Recommended</div>
            <div class="start-profile">
                <div class="profile-avatar">U</div>
                <span style="font-size: 12px;">User</span>
            </div>
        </div>

        <div class="recommended-grid">
            <div class="recommended-item" onclick="openApp('notepad'); toggleStart()">
                <div class="recommended-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32">
                        <rect width="32" height="32" rx="4" fill="#f5f5f5"/>
                        <line x1="8" y1="12" x2="24" y2="12" stroke="#999" stroke-width="2"/>
                        <line x1="8" y1="18" x2="24" y2="18" stroke="#999" stroke-width="2"/>
                    </svg>
                </div>
                <div class="recommended-info">
                    <div class="recommended-name">Notes.txt</div>
                    <div class="recommended-time">Recently opened</div>
                </div>
            </div>
            <div class="recommended-item" onclick="openApp('word'); toggleStart()">
                <div class="recommended-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32">
                        <rect width="32" height="32" rx="4" fill="#2b579a"/>
                        <text x="16" y="22" fill="white" font-size="16" font-weight="bold" font-family="Arial" text-anchor="middle">W</text>
                    </svg>
                </div>
                <div class="recommended-info">
                    <div class="recommended-name">Document.docx</div>
                    <div class="recommended-time">Yesterday</div>
                </div>
            </div>
            <div class="recommended-item" onclick="openApp('paint'); toggleStart()">
                <div class="recommended-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32">
                        <rect width="32" height="32" rx="4" fill="#1a1a1a"/>
                        <circle cx="10" cy="10" r="4" fill="#ff5f57"/>
                        <circle cx="22" cy="10" r="4" fill="#28c840"/>
                        <circle cx="10" cy="22" r="4" fill="#ffbd2e"/>
                        <circle cx="22" cy="22" r="4" fill="#007aff"/>
                    </svg>
                </div>
                <div class="recommended-info">
                    <div class="recommended-name">Drawing.png</div>
                    <div class="recommended-time">Last week</div>
                </div>
            </div>
            <div class="recommended-item" onclick="openApp('explorer'); toggleStart()">
                <div class="recommended-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32">
                        <rect x="4" y="6" width="14" height="20" rx="2" fill="#f0c33c"/>
                        <rect x="14" y="4" width="14" height="22" rx="2" fill="#f0c33c"/>
                    </svg>
                </div>
                <div class="recommended-info">
                    <div class="recommended-name">Downloads</div>
                    <div class="recommended-time">Pinned</div>
                </div>
            </div>
        </div>

        <div style="margin-top: 24px;">
            <div class="start-section-title">Pinned</div>
            <div class="start-grid">
                <div class="start-item" onclick="openApp('word'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="#2b579a"/><text x="24" y="33" fill="white" font-size="26" font-weight="bold" font-family="Arial" text-anchor="middle">W</text></svg>
                    Word
                </div>
                <div class="start-item" onclick="openApp('excel'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="#217346"/><text x="24" y="33" fill="white" font-size="26" font-weight="bold" font-family="Arial" text-anchor="middle">X</text></svg>
                    Excel
                </div>
                <div class="start-item" onclick="openApp('powerpoint'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="#b7472a"/><text x="24" y="33" fill="white" font-size="26" font-weight="bold" font-family="Arial" text-anchor="middle">P</text></svg>
                    PowerPoint
                </div>
                <div class="start-item" onclick="openApp('paint'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="#1a1a1a"/><circle cx="24" cy="24" r="10" fill="none" stroke="white" stroke-width="2"/></svg>
                    Paint
                </div>
                <div class="start-item" onclick="openApp('calculator'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="#202020"/><text x="24" y="33" fill="white" font-size="22" font-family="Arial" text-anchor="middle">=</text></svg>
                    Calculator
                </div>
                <div class="start-item" onclick="openApp('notepad'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="white"/><line x1="12" y1="16" x2="36" y2="16" stroke="#333" stroke-width="2"/></svg>
                    Notepad
                </div>
                <div class="start-item" onclick="openApp('chrome'); toggleStart()">
                    <svg viewBox="0 0 48 48"><circle cx="24" cy="24" r="20" fill="#4285f4"/><circle cx="24" cy="24" r="8" fill="white"/></svg>
                    Chrome
                </div>
                <div class="start-item" onclick="openApp('explorer'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect x="4" y="10" width="24" height="28" rx="2" fill="#f0c33c"/><rect x="20" y="6" width="24" height="32" rx="2" fill="#f0c33c"/></svg>
                    Explorer
                </div>
                <div class="start-item" onclick="openApp('edge'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="#0078d4"/><path d="M24 8c8.8 0 16 7.2 16 16 0 8.8-7.2 16-16 16-8.8 0-16-7.2-16-16 0-5.6 3.2-10.4 8-13.2l8 13.2h16V8l-16 10.4z" fill="white"/></svg>
                    Edge
                </div>
                <div class="start-item" onclick="openApp('photos'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="#2a2a2a"/><circle cx="24" cy="18" r="7" fill="#ffd93d"/><circle cx="24" cy="32" r="7" fill="#60a5fa"/></svg>
                    Photos
                </div>
                <div class="start-item" onclick="openApp('settings'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="#404040"/><circle cx="24" cy="24" r="8" fill="none" stroke="white" stroke-width="3"/><circle cx="24" cy="8" r="3" fill="white"/><circle cx="24" cy="40" r="3" fill="white"/><circle cx="8" cy="24" r="3" fill="white"/><circle cx="40" cy="24" r="3" fill="white"/></svg>
                    Settings
                </div>
                <div class="start-item" onclick="openApp('store'); toggleStart()">
                    <svg viewBox="0 0 48 48"><rect width="48" height="48" rx="6" fill="#00a4ef"/><rect x="10" y="10" width="28" height="28" rx="3" fill="white"/><text x="24" y="30" fill="#00a4ef" font-size="14" font-weight="bold" font-family="Arial" text-anchor="middle">S</text></svg>
                    Store
                </div>
            </div>
        </div>

        <div class="start-footer">
            <button class="power-btn" title="Power" onclick="showPowerMenu()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="white">
                    <path d="M12 3v9" stroke="white" stroke-width="2" fill="none"/>
                    <path d="M18.4 6.6a9 9 0 1 1-12.8 0" stroke="white" stroke-width="2" fill="none"/>
                </svg>
            </button>
            <button class="power-btn" title="All apps" onclick="showAllApps()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="white">
                    <rect x="3" y="3" width="7" height="7" rx="1"/>
                    <rect x="14" y="3" width="7" height="7" rx="1"/>
                    <rect x="3" y="14" width="7" height="7" rx="1"/>
                    <rect x="14" y="14" width="7" height="7" rx="1"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="context-menu">
        <div class="context-item" onclick="refreshDesktop()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
                <path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
            </svg>
            Refresh
        </div>
        <div class="context-divider"></div>
        <div class="context-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
            New
        </div>
        <div class="context-divider"></div>
        <div class="context-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
                <path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
            </svg>
            Sort by
        </div>
        <div class="context-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
                <path d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"/>
            </svg>
            View
        </div>
    </div>

    <script>
        // Global state
        let zIndex = 100;
        let activeWindows = {};
        let windowCount = 0;
        let draggedWindow = null;
        let dragOffsetX = 0;
        let dragOffsetY = 0;
        let resizeMode = null;
        let resizeStartX, resizeStartY, resizeStartWidth, resizeStartHeight;

        // Clock
        function updateClock() {
            const now = new Date();
            document.getElementById('time').textContent = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
            document.getElementById('date').textContent = now.toLocaleDateString('en-US', { month: 'numeric', day: 'numeric', year: 'numeric' });
        }
        setInterval(updateClock, 1000);
        updateClock();

        // Start Menu
        function toggleStart() {
            const startMenu = document.getElementById('start-menu');
            startMenu.classList.toggle('active');
        }

        // Context Menu
        function showDesktopContext(e) {
            e.preventDefault();
            const menu = document.getElementById('context-menu');
            menu.style.display = 'block';
            menu.style.left = e.clientX + 'px';
            menu.style.top = e.clientY + 'px';
        }

        document.addEventListener('click', (e) => {
            const menu = document.getElementById('context-menu');
            if (!menu.contains(e.target)) {
                menu.style.display = 'none';
            }
            const startMenu = document.getElementById('start-menu');
            if (!startMenu.contains(e.target) && !e.target.closest('#taskbar')) {
                startMenu.classList.remove('active');
            }
        });

        function refreshDesktop() {
            document.getElementById('context-menu').style.display = 'none';
        }

        function showPowerMenu() {
            alert('Power options would appear here');
        }

        function showAllApps() {
            alert('All apps view would appear here');
        }

        // Window Management
        function openApp(app) {
            windowCount++;
            const id = 'win-' + windowCount;
            const win = document.createElement('div');
            win.className = 'window';
            win.id = id;
            
            // Position windows with cascading effect
            const offset = windowCount * 30;
            win.style.left = Math.min(100 + offset, window.innerWidth - 400) + 'px';
            win.style.top = Math.min(50 + offset, window.innerHeight - 400) + 'px';
            win.style.width = '800px';
            win.style.height = '600px';
            win.style.zIndex = ++zIndex;

            let title, content, icon, width = '800px', height = '600px';

            switch (app) {
                case 'notepad':
                    title = 'Untitled - Notepad';
                    icon = '<svg viewBox="0 0 24 24" fill="#888"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/></svg>';
                    content = `<textarea class="notepad-textarea" placeholder="Type something here..."></textarea>`;
                    width = '600px';
                    height = '400px';
                    break;

                case 'calculator':
                    title = 'Calculator';
                    icon = '<svg viewBox="0 0 24 24" fill="#60a5fa"><rect x="4" y="2" width="16" height="20" rx="2" fill="#333"/><rect x="7" y="5" width="10" height="4" fill="#60a5fa" rx="1"/></svg>';
                    content = `
                        <div class="calc-container">
                            <div class="calc-display">
                                <div class="calc-expression" id="calc-expr"></div>
                                <div class="calc-result" id="calc-display">0</div>
                            </div>
                            <div class="calc-buttons">
                                <button class="calc-btn" onclick="calcClear()">C</button>
                                <button class="calc-btn" onclick="calcInput('(')">(</button>
                                <button class="calc-btn" onclick="calcInput(')')">)</button>
                                <button class="calc-btn operator" onclick="calcOp('/')">÷</button>
                                <button class="calc-btn" onclick="calcInput('7')">7</button>
                                <button class="calc-btn" onclick="calcInput('8')">8</button>
                                <button class="calc-btn" onclick="calcInput('9')">9</button>
                                <button class="calc-btn operator" onclick="calcOp('*')">×</button>
                                <button class="calc-btn" onclick="calcInput('4')">4</button>
                                <button class="calc-btn" onclick="calcInput('5')">5</button>
                                <button class="calc-btn" onclick="calcInput('6')">6</button>
                                <button class="calc-btn operator" onclick="calcOp('-')">−</button>
                                <button class="calc-btn" onclick="calcInput('1')">1</button>
                                <button class="calc-btn" onclick="calcInput('2')">2</button>
                                <button class="calc-btn" onclick="calcInput('3')">3</button>
                                <button class="calc-btn operator" onclick="calcOp('+')">+</button>
                                <button class="calc-btn" onclick="calcInput('0')">0</button>
                                <button class="calc-btn" onclick="calcInput('00')">00</button>
                                <button class="calc-btn" onclick="calcInput('.')">.</button>
                                <button class="calc-btn equals" onclick="calcEquals()">=</button>
                            </div>
                        </div>
                    `;
                    width = '320px';
                    height = '500px';
                    break;

                case 'paint':
                    title = 'Paint';
                    icon = '<svg viewBox="0 0 24 24" fill="#ff6b6b"><circle cx="12" cy="12" r="8"/></svg>';
                    content = `
                        <div class="paint-toolbar">
                            <div class="paint-tool-section">
                                <button class="tool-btn active" title="Brush" id="paint-brush">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M7 14c-1.66 0-3 1.34-3 3 0 1.31-1.16 2-2 2 .92 1.22 2.49 2 4 2 2.21 0 4-1.79 4-4 0-1.66-1.34-3-3-3zm13.71-9.37l-1.34-1.34a.996.996 0 00-1.41 0L9 12.25 11.75 15l8.96-8.96a.996.996 0 000-1.41z"/></svg>
                                </button>
                                <button class="tool-btn" title="Eraser" id="paint-eraser" onclick="setPaintTool('eraser')">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.78-.78 2.05 0 2.83L5.17 20.17c.78.78 2.05.78 2.83 0l11.14-11.14c.78-.78.78-2.05 0-2.83l-2.59-2.59A2.04 2.04 0 0015.14 3z"/></svg>
                                </button>
                            </div>
                            <div class="paint-tool-section">
                                <div class="color-btn active" style="background: #000000" onclick="setPaintColor('#000000', this)"></div>
                                <div class="color-btn" style="background: #ff0000" onclick="setPaintColor('#ff0000', this)"></div>
                                <div class="color-btn" style="background: #00ff00" onclick="setPaintColor('#00ff00', this)"></div>
                                <div class="color-btn" style="background: #0000ff" onclick="setPaintColor('#0000ff', this)"></div>
                                <div class="color-btn" style="background: #ffff00" onclick="setPaintColor('#ffff00', this)"></div>
                                <div class="color-btn" style="background: #ff00ff" onclick="setPaintColor('#ff00ff', this)"></div>
                                <div class="color-btn" style="background: #00ffff" onclick="setPaintColor('#00ffff', this)"></div>
                                <div class="color-btn" style="background: #ffffff; border: 1px solid #444;" onclick="setPaintColor('#ffffff', this)"></div>
                            </div>
                            <div class="paint-tool-section">
                                <input type="range" class="size-slider" min="1" max="30" value="3" id="paint-size" onchange="updatePaintSize()">
                                <span style="color: #aaa; font-size: 11px;" id="paint-size-display">3px</span>
                            </div>
                            <div class="paint-tool-section" style="margin-left: auto; border: none;">
                                <button class="tool-btn" onclick="clearPaint()" title="Clear">🗑️</button>
                                <button class="tool-btn" onclick="savePaint()" title="Save">💾</button>
                            </div>
                        </div>
                        <div class="paint-canvas-container">
                            <canvas class="paint-canvas" id="paint-canvas" width="750" height="480"></canvas>
                        </div>
                    `;
                    setTimeout(initPaint, 0);
                    break;

                case 'word':
                    title = 'Document1 - Word';
                    icon = '<svg viewBox="0 0 24 24" fill="white"><rect width="24" height="24" rx="3" fill="#2b579a"/><text x="12" y="17" font-size="14" font-weight="bold" fill="white" text-anchor="middle" font-family="Arial">W</text></svg>';
                    content = `
                        <div class="word-container">
                            <div class="word-toolbar">
                                <button class="toolbar-btn" onclick="document.execCommand('bold')"><b>B</b></button>
                                <button class="toolbar-btn" onclick="document.execCommand('italic')"><i>I</i></button>
                                <button class="toolbar-btn" onclick="document.execCommand('underline')"><u>U</u></button>
                                <button class="toolbar-divider"></button>
                                <button class="toolbar-btn" onclick="document.execCommand('justifyLeft')">⬅</button>
                                <button class="toolbar-btn" onclick="document.execCommand('justifyCenter')">↔</button>
                                <button class="toolbar-btn" onclick="document.execCommand('justifyRight')">➡</button>
                                <button class="toolbar-btn" onclick="document.execCommand('justifyFull')">≡</button>
                                <div class="toolbar-divider"></div>
                                <select onchange="document.execCommand('fontSize', false, this.value)" style="background: rgba(255,255,255,0.1); color: white; border: none; padding: 4px 8px; border-radius: 3px; font-size: 12px;">
                                    <option value="1">8</option>
                                    <option value="2">10</option>
                                    <option value="3" selected>12</option>
                                    <option value="4">14</option>
                                    <option value="5">18</option>
                                    <option value="6">24</option>
                                    <option value="7">36</option>
                                </select>
                            </div>
                            <div class="word-editor">
                                <div class="word-page" contenteditable="true">
                                    <h1 style="text-align: center; margin-bottom: 18pt;">Welcome to Word</h1>
                                    <p>This is a simple word processor. You can type your text here, format it using the toolbar above, and create beautiful documents.</p>
                                    <p><b>Features available:</b></p>
                                    <ul>
                                        <li>Bold, italic, and underline text</li>
                                        <li>Text alignment options</li>
                                        <li>Font size selection</li>
                                        <li>Rich text editing</li>
                                    </ul>
                                    <p>Start typing to create your document...</p>
                                    <p><br></p>
                                    <p style="text-align: center; color: #666;"><i>Double-click to select text</i></p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'explorer':
                    title = 'File Explorer';
                    icon = '<svg viewBox="0 0 24 24" fill="#f0c33c"><path d="M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"/></svg>';
                    content = `
                        <div class="explorer-container">
                            <div class="explorer-toolbar">
                                <div class="chrome-nav">
                                    <button class="explorer-nav-btn" disabled>←</button>
                                    <button class="explorer-nav-btn" disabled>→</button>
                                </div>
                                <div class="explorer-path">
                                    <span>📁</span>
                                    <span id="explorer-path-text">This PC > Desktop</span>
                                </div>
                            </div>
                            <div class="explorer-body">
                                <div class="explorer-sidebar">
                                    <div class="explorer-sidebar-item" onclick="navigateExplorer('desktop', this)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#60a5fa"><path d="M12 2L2 12h3v8h6v-6h2v6h6v-8h3L12 2z"/></svg>
                                        Desktop
                                    </div>
                                    <div class="explorer-sidebar-item" onclick="navigateExplorer('downloads', this)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#f0c33c"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                                        Downloads
                                    </div>
                                    <div class="explorer-sidebar-item" onclick="navigateExplorer('documents', this)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#60a5fa"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/></svg>
                                        Documents
                                    </div>
                                    <div class="explorer-sidebar-item" onclick="navigateExplorer('pictures', this)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#a78bfa"><circle cx="12" cy="12" r="8"/></svg>
                                        Pictures
                                    </div>
                                    <div class="explorer-sidebar-item" onclick="navigateExplorer('music', this)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#f472b6"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
                                        Music
                                    </div>
                                    <div class="explorer-sidebar-item" onclick="navigateExplorer('video', this)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#4ade80"><rect x="2" y="4" width="20" height="16" rx="2"/></svg>
                                        Videos
                                    </div>
                                    <div class="explorer-sidebar-item" onclick="navigateExplorer('thispc', this)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#888"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 17h8v2H8z"/></svg>
                                        This PC
                                    </div>
                                </div>
                                <div class="explorer-main" id="explorer-content">
                                    <div class="file-item">
                                        <div class="file-icon">
                                            <svg width="48" height="48" viewBox="0 0 48 48">
                                                <rect x="8" y="8" width="32" height="32" rx="4" fill="#60a5fa"/>
                                                <text x="24" y="30" fill="white" font-size="12" font-weight="bold" text-anchor="middle" font-family="Arial">DOC</text>
                                            </svg>
                                        </div>
                                        <div class="file-name">Resume.docx</div>
                                    </div>
                                    <div class="file-item">
                                        <div class="file-icon">
                                            <svg width="48" height="48" viewBox="0 0 48 48">
                                                <rect x="4" y="10" width="20" height="28" rx="2" fill="#f0c33c"/>
                                                <rect x="24" y="6" width="20" height="32" rx="2" fill="#f0c33c"/>
                                            </svg>
                                        </div>
                                        <div class="file-name">Work</div>
                                    </div>
                                    <div class="file-item">
                                        <div class="file-icon">
                                            <svg width="48" height="48" viewBox="0 0 48 48">
                                                <rect x="4" y="10" width="20" height="28" rx="2" fill="#f0c33c"/>
                                                <rect x="24" y="6" width="20" height="32" rx="2" fill="#f0c33c"/>
                                            </svg>
                                        </div>
                                        <div class="file-name">Personal</div>
                                    </div>
                                    <div class="file-item">
                                        <div class="file-icon">
                                            <svg width="48" height="48" viewBox="0 0 48 48">
                                                <rect x="8" y="8" width="32" height="32" rx="4" fill="#217346"/>
                                                <text x="24" y="30" fill="white" font-size="12" font-weight="bold" text-anchor="middle" font-family="Arial">XLS</text>
                                            </svg>
                                        </div>
                                        <div class="file-name">Budget.xlsx</div>
                                    </div>
                                    <div class="file-item">
                                        <div class="file-icon">
                                            <svg width="48" height="48" viewBox="0 0 48 48">
                                                <rect x="8" y="8" width="32" height="32" rx="4" fill="#1a1a1a"/>
                                                <circle cx="24" cy="24" r="10" fill="white"/>
                                            </svg>
                                        </div>
                                        <div class="file-name">Photo.png</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'chrome':
                    title = 'Chrome';
                    icon = '<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="#4285f4"/><circle cx="12" cy="12" r="4" fill="white"/></svg>';
                    content = `
                        <div class="chrome-container">
                            <div class="chrome-toolbar">
                                <div class="chrome-nav">
                                    <button class="chrome-btn" onclick="chromeBack(this)">←</button>
                                    <button class="chrome-btn" onclick="chromeForward(this)">→</button>
                                    <button class="chrome-btn" onclick="chromeReload(this)">↻</button>
                                </div>
                                <div class="chrome-address-wrapper">
                                    <span class="chrome-secure">🔒</span>
                                    <input class="chrome-address" type="text" value="https://www.google.com" id="chrome-url" onkeydown="if(event.key==='Enter') chromeGo(this.value, this)">
                                    <span class="chrome-more">⋮</span>
                                </div>
                            </div>
                            <iframe class="chrome-frame" id="chrome-frame" src="https://www.google.com/search?q=windows+11"></iframe>
                        </div>
                    `;
                    width = '900px';
                    height = '600px';
                    break;

                case 'excel':
                    title = 'Book1 - Excel';
                    icon = '<svg viewBox="0 0 24 24"><rect width="24" height="24" rx="3" fill="#217346"/><text x="12" y="17" fill="white" font-size="14" font-weight="bold" text-anchor="middle" font-family="Arial">X</text></svg>';
                    content = `
                        <div class="word-container" style="background: white;">
                            <div style="background: #217346; padding: 8px 12px; color: white; font-weight: 600; font-size: 13px;">Book1 - Excel</div>
                            <div style="background: #f3f3f3; padding: 4px 8px; border-bottom: 1px solid #ddd; display: flex; gap: 4px;">
                                <input style="width: 60px; border: 1px solid #ccc; padding: 2px 4px; font-size: 11px;" value="A1">
                                <span style="color: #666;">fx</span>
                                <input style="flex: 1; border: 1px solid #ccc; padding: 2px 4px; font-size: 11px;">
                            </div>
                            <div style="padding: 20px; background: white; height: calc(100% - 60px); overflow: auto;">
                                <table id="excel-table" style="border-collapse: collapse; font-family: Calibri; font-size: 11pt; min-width: 100%;">
                                    ${generateExcelTable()}
                                </table>
                            </div>
                        </div>
                    `;
                    break;

                case 'powerpoint':
                    title = 'Presentation1 - PowerPoint';
                    icon = '<svg viewBox="0 0 24 24"><rect width="24" height="24" rx="3" fill="#b7472a"/><text x="12" y="17" fill="white" font-size="14" font-weight="bold" text-anchor="middle" font-family="Arial">P</text></svg>';
                    content = `
                        <div class="word-container">
                            <div style="background: #b7472a; padding: 8px 12px; color: white; font-weight: 600; font-size: 13px;">Presentation1</div>
                            <div style="flex: 1; display: flex; background: #1a1a1a;">
                                <div style="width: 200px; background: #2d2d2d; padding: 12px;">
                                    <div style="color: #888; font-size: 11px; margin-bottom: 8px;">Slides</div>
                                    <div style="background: #b7472a; border-radius: 4px; padding: 20px; margin-bottom: 8px; text-align: center; color: white;">
                                        <div style="font-size: 24px; margin-bottom: 8px;">📊</div>
                                        <div style="font-size: 12px;">Title Slide</div>
                                    </div>
                                    <div style="background: #333; border-radius: 4px; padding: 20px; text-align: center; color: #888;">
                                        <div style="font-size: 12px;">+</div>
                                    </div>
                                </div>
                                <div style="flex: 1; display: flex; align-items: center; justify-content: center; background: #333;">
                                    <div style="background: white; width: 480px; height: 270px; border-radius: 4px; display: flex; align-items: center; justify-content: center; flex-direction: column; padding: 40px;">
                                        <h1 style="font-size: 36px; color: #b7472a; margin-bottom: 16px;">Your Title Here</h1>
                                        <p style="color: #666;">Click to add subtitle</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'edge':
                    title = 'Microsoft Edge';
                    icon = '<svg viewBox="0 0 24 24"><rect width="24" height="24" rx="3" fill="#0078d4"/><path d="M12 4c4.4 0 8 3.6 8 8 0 4.4-3.6 8-8 8-2.8 0-5.4-1.4-6.8-3.6l4 6.6H4V9l4.8-1.4C10.6 5.4 14.2 4 12 4z" fill="white"/></svg>';
                    content = `
                        <div class="chrome-container">
                            <div class="chrome-toolbar">
                                <div class="chrome-nav">
                                    <button class="chrome-btn">←</button>
                                    <button class="chrome-btn">→</button>
                                    <button class="chrome-btn">↻</button>
                                </div>
                                <div class="chrome-address-wrapper">
                                    <span class="chrome-secure">🔒</span>
                                    <input class="chrome-address" type="text" value="https://www.bing.com">
                                </div>
                            </div>
                            <div style="flex: 1; background: #1a1a1a; display: flex; align-items: center; justify-content: center;">
                                <div style="text-align: center; color: white;">
                                    <svg width="64" height="64" viewBox="0 0 24 24" fill="#0078d4" style="margin-bottom: 16px;"><path d="M12 4c4.4 0 8 3.6 8 8 0 4.4-3.6 8-8 8-2.8 0-5.4-1.4-6.8-3.6l4 6.6H4V9l4.8-1.4C10.6 5.4 14.2 4 12 4z"/></svg>
                                    <h2 style="margin-bottom: 8px;">Microsoft Edge</h2>
                                    <p style="color: #888;">Browser simulation</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'photos':
                    title = 'Photos';
                    icon = '<svg viewBox="0 0 24 24"><rect width="24" height="24" rx="3" fill="#2a2a2a"/><circle cx="12" cy="10" r="4" fill="#ffd93d"/><circle cx="12" cy="16" r="4" fill="#60a5fa"/></svg>';
                    content = `
                        <div style="height: 100%; background: #1a1a1a; display: flex; flex-direction: column;">
                            <div style="padding: 16px; color: white; font-size: 14px; border-bottom: 1px solid #333;">Photos</div>
                            <div style="flex: 1; padding: 20px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; align-content: start;">
                                <div style="aspect-ratio: 1; background: linear-gradient(135deg, #ff6b6b, #ffd93d); border-radius: 8px;"></div>
                                <div style="aspect-ratio: 1; background: linear-gradient(135deg, #60a5fa, #a78bfa); border-radius: 8px;"></div>
                                <div style="aspect-ratio: 1; background: linear-gradient(135deg, #4ade80, #22d3ee); border-radius: 8px;"></div>
                                <div style="aspect-ratio: 1; background: linear-gradient(135deg, #f472b6, #fb923c); border-radius: 8px;"></div>
                                <div style="aspect-ratio: 1; background: linear-gradient(135deg, #818cf8, #c084fc); border-radius: 8px;"></div>
                                <div style="aspect-ratio: 1; background: linear-gradient(135deg, #2dd4bf, #34d399); border-radius: 8px;"></div>
                            </div>
                        </div>
                    `;
                    break;

                case 'settings':
                    title = 'Settings';
                    icon = '<svg viewBox="0 0 24 24"><rect width="24" height="24" rx="3" fill="#404040"/><circle cx="12" cy="12" r="4" fill="none" stroke="white" stroke-width="2"/><circle cx="12" cy="4" r="1.5" fill="white"/><circle cx="12" cy="20" r="1.5" fill="white"/><circle cx="4" cy="12" r="1.5" fill="white"/><circle cx="20" cy="12" r="1.5" fill="white"/></svg>';
                    content = `
                        <div style="height: 100%; display: flex;">
                            <div style="width: 200px; background: #1e1e1e; padding: 16px; color: white;">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 24px;">
                                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #60a5fa, #a78bfa); border-radius: 50%; display: flex; align-items: center; justify-content: center;">U</div>
                                    <div>
                                        <div style="font-weight: 600;">User</div>
                                        <div style="font-size: 11px; color: #888;">Local Account</div>
                                    </div>
                                </div>
                                <div style="padding: 10px 12px; background: rgba(255,255,255,0.1); border-radius: 4px; margin-bottom: 8px; font-size: 13px;">💻 System</div>
                                <div style="padding: 10px 12px; color: #ccc; font-size: 13px;">📶 Network</div>
                                <div style="padding: 10px 12px; color: #ccc; font-size: 13px;">🎨 Personalization</div>
                                <div style="padding: 10px 12px; color: #ccc; font-size: 13px;">🔔 Apps</div>
                                <div style="padding: 10px 12px; color: #ccc; font-size: 13px;">👤 Accounts</div>
                                <div style="padding: 10px 12px; color: #ccc; font-size: 13px;">⏰ Time</div>
                                <div style="padding: 10px 12px; color: #ccc; font-size: 13px;">♿ Accessibility</div>
                                <div style="padding: 10px 12px; color: #ccc; font-size: 13px;">🔒 Privacy</div>
                                <div style="padding: 10px 12px; color: #ccc; font-size: 13px;">🔄 Update</div>
                            </div>
                            <div style="flex: 1; padding: 24px; background: #252525; color: white;">
                                <h2 style="margin-bottom: 20px;">System</h2>
                                <div style="background: #2d2d2d; border-radius: 8px; padding: 16px; margin-bottom: 12px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>Dark mode</span>
                                        <div style="width: 36px; height: 20px; background: #60a5fa; border-radius: 10px; position: relative;">
                                            <div style="width: 16px; height: 16px; background: white; border-radius: 50%; position: absolute; right: 2px; top: 2px;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div style="background: #2d2d2d; border-radius: 8px; padding: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>Night light</span>
                                        <div style="width: 36px; height: 20px; background: #444; border-radius: 10px; position: relative;">
                                            <div style="width: 16px; height: 16px; background: #888; border-radius: 50%; position: absolute; left: 2px; top: 2px;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'store':
                    title = 'Microsoft Store';
                    icon = '<svg viewBox="0 0 24 24"><rect width="24" height="24" rx="3" fill="#00a4ef"/><rect x="6" y="6" width="12" height="12" rx="2" fill="white"/><text x="12" y="14" fill="#00a4ef" font-size="8" font-weight="bold" text-anchor="middle" font-family="Arial">S</text></svg>';
                    content = `
                        <div style="height: 100%; display: flex; flex-direction: column;">
                            <div style="padding: 16px; border-bottom: 1px solid #333;">
                                <input type="text" placeholder="🔍 Search" style="width: 100%; max-width: 400px; background: #333; border: none; padding: 10px 16px; border-radius: 20px; color: white;">
                            </div>
                            <div style="flex: 1; padding: 20px; overflow: auto;">
                                <h3 style="color: white; margin-bottom: 16px;">Featured</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 16px;">
                                    <div style="background: linear-gradient(135deg, #6366f1, #8b5cf6); border-radius: 12px; padding: 20px; color: white; text-align: center;">
                                        <div style="font-size: 32px; margin-bottom: 12px;">🎮</div>
                                        <div style="font-weight: 600; margin-bottom: 4px;">Game Pass</div>
                                        <div style="font-size: 11px; opacity: 0.8;">Play 100+ games</div>
                                    </div>
                                    <div style="background: linear-gradient(135deg, #0ea5e9, #2dd4bf); border-radius: 12px; padding: 20px; color: white; text-align: center;">
                                        <div style="font-size: 32px; margin-bottom: 12px;">💼</div>
                                        <div style="font-weight: 600; margin-bottom: 4px;">Office 365</div>
                                        <div style="font-size: 11px; opacity: 0.8;">Productivity suite</div>
                                    </div>
                                    <div style="background: linear-gradient(135deg, #f59e0b, #f97316); border-radius: 12px; padding: 20px; color: white; text-align: center;">
                                        <div style="font-size: 32px; margin-bottom: 12px;">🖥️</div>
                                        <div style="font-weight: 600; margin-bottom: 4px;">Windows 11</div>
                                        <div style="font-size: 11px; opacity: 0.8;">Latest OS</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
            }

            win.style.width = width;
            win.style.height = height;
            win.innerHTML = `
                <div class="title-bar" onmousedown="startDrag(event, '${id}')">
                    <div class="window-title">
                        ${icon}
                       title}</span>
                    </div>
                    <div class="window-controls">
                        <button class="win-btn" <span>${ onclick="minimizeWindow('${id}')" }title="Minimize">─</button>
                        <button class="win-btn" onclick="maximizeWindow('${id}')" title="Maximize">□</button>
                        <button class="win-btn close" onclick="closeWindow('${id}')" title="Close">×</button>
                    </div>
                </div>
                <div class="window-content">
                    ${content}
                </div>
            `;

            document.body.appendChild(win);
            activeWindows[id] = win;

            win.addEventListener('mousedown', () => {
                win.style.zIndex = ++zIndex;
            });

            // Bring start menu to front
            document.getElementById('start-menu').classList.remove('active');
        }

        function closeWindow(id) {
            const win = document.getElementById(id);
            if (win) {
                win.remove();
                delete activeWindows[id];
            }
        }

        function maximizeWindow(id) {
            const win = document.getElementById(id);
            if (win) {
                win.classList.toggle('maximized');
            }
        }

        function minimizeWindow(id) {
            const win = document.getElementById(id);
            if (win) {
                win.style.transition = 'transform 0.2s ease, opacity 0.2s ease';
                win.style.transform = 'scale(0.7)';
                win.style.opacity = '0';
                setTimeout(() => {
                    win.style.display = 'none';
                    win.style.transform = '';
                    win.style.opacity = '';
                }, 200);
                setTimeout(() => {
                    win.style.display = 'flex';
                    win.style.transition = '';
                }, 3000);
            }
        }

        function startDrag(e, id) {
            if (e.target.closest('.window-controls')) return;
            const win = document.getElementById(id);
            if (win.classList.contains('maximized')) return;
            draggedWindow = win;
            dragOffsetX = e.clientX - win.offsetLeft;
            dragOffsetY = e.clientY - win.offsetTop;
            draggedWindow.style.zIndex = ++zIndex;
        }

        document.addEventListener('mousemove', (e) => {
            if (draggedWindow) {
                draggedWindow.style.left = (e.clientX - dragOffsetX) + 'px';
                draggedWindow.style.top = (e.clientY - dragOffsetY) + 'px';
            }
        });

        document.addEventListener('mouseup', () => {
            draggedWindow = null;
        });

        // Calculator Logic
        let calcExpression = '';
        let calcNewNumber = true;

        function calcInput(val) {
            const display = document.getElementById('calc-display');
            const expr = document.getElementById('calc-expr');
            
            if (calcNewNumber && val !== '.') {
                display.textContent = val;
                if (calcExpression) {
                    expr.textContent = calcExpression;
                }
            } else {
                if (val === '.' && display.textContent.includes('.')) return;
                display.textContent += val;
            }
            calcNewNumber = false;
        }

        function calcOp(op) {
            const display = document.getElementById('calc-display');
            const expr = document.getElementById('calc-expr');
            
            if (!calcExpression) {
                calcExpression = display.textContent + ' ' + op;
            } else {
                calcExpression = expr.textContent + ' ' + display.textContent + ' ' + op;
            }
            expr.textContent = calcExpression;
            calcNewNumber = true;
        }

        function calcClear() {
            calcExpression = '';
            calcNewNumber = true;
            document.getElementById('calc-display').textContent = '0';
            document.getElementById('calc-expr').textContent = '';
        }

        function calcEquals() {
            const display = document.getElementById('calc-display');
            const expr = document.getElementById('calc-expr');
            
            if (!calcExpression) return;
            
            const fullExpr = expr.textContent + ' ' + display.textContent;
            try {
                // Safe evaluation
                const result = eval(fullExpr.replace(/×/g, '*').replace(/÷/g, '/').replace(/−/g, '-'));
                display.textContent = Number.isInteger(result) ? result : result.toFixed(2);
                calcExpression = '';
                expr.textContent = '';
                calcNewNumber = true;
            } catch {
                display.textContent = 'Error';
                calcExpression = '';
                calcNewNumber = true;
            }
        }

        // Paint Logic
        let paintColor = '#000000';
        let paintTool = 'brush';
        let paintSize = 3;
        let isDrawing = false;
        let canvas, ctx;

        function initPaint() {
            canvas = document.getElementById('paint-canvas');
            if (!canvas) return;
            ctx = canvas.getContext('2d');
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            canvas.addEventListener('mousedown', startPaint);
            canvas.addEventListener('mousemove', drawPaint);
            canvas.addEventListener('mouseup', stopPaint);
            canvas.addEventListener('mouseleave', stopPaint);
            
            // Touch support
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const rect = canvas.getBoundingClientRect();
                startPaint({ offsetX: touch.clientX - rect.left, offsetY: touch.clientY - rect.top });
            });
            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const rect = canvas.getBoundingClientRect();
                drawPaint({ offsetX: touch.clientX - rect.left, offsetY: touch.clientY - rect.top });
            });
            canvas.addEventListener('touchend', stopPaint);
        }

        function setPaintColor(color, btn) {
            paintColor = color;
            document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function setPaintTool(tool) {
            paintTool = tool;
            document.getElementById('paint-brush').classList.toggle('active', tool === 'brush');
            document.getElementById('paint-eraser').classList.toggle('active', tool === 'eraser');
        }

        function updatePaintSize() {
            paintSize = document.getElementById('paint-size').value;
            document.getElementById('paint-size-display').textContent = paintSize + 'px';
        }

        function startPaint(e) {
            isDrawing = true;
            ctx.beginPath();
            ctx.moveTo(e.offsetX, e.offsetY);
            ctx.lineWidth = paintTool === 'eraser' ? paintSize * 3 : paintSize;
            ctx.strokeStyle = paintTool === 'eraser' ? '#ffffff' : paintColor;
            ctx.fillStyle = paintTool === 'eraser' ? '#ffffff' : paintColor;
        }

        function drawPaint(e) {
            if (!isDrawing) return;
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke();
        }

        function stopPaint() {
            isDrawing = false;
        }

        function clearPaint() {
            if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function savePaint() {
            if (!canvas) return;
            const link = document.createElement('a');
            link.download = 'painting-' + Date.now() + '.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // Chrome Functions
        function chromeGo(url, input) {
            if (!url.startsWith('http')) {
                url = 'https://' + url;
            }
            document.getElementById('chrome-frame').src = url;
            input.value = url;
        }

        function chromeBack(btn) {
            document.getElementById('chrome-frame').contentWindow.history.back();
        }

        function chromeForward(btn) {
            document.getElementById('chrome-frame').contentWindow.history.forward();
        }

        function chromeReload(btn) {
            document.getElementById('chrome-frame').src = document.getElementById('chrome-frame').src;
        }

        // Explorer Functions
        const explorerData = {
            desktop: [
                { name: 'Documents', type: 'folder' },
                { name: 'Downloads', type: 'folder' },
                { name: 'Pictures', type: 'folder' },
                { name: 'Notes.txt', type: 'file' }
            ],
            downloads: [
                { name: 'installer.exe', type: 'file' },
                { name: 'photo.jpg', type: 'file' },
                { name: 'document.pdf', type: 'file' },
                { name: 'archive.zip', type: 'file' }
            ],
            documents: [
                { name: 'Resume.docx', type: 'file' },
                { name: 'Report.docx', type: 'file' },
                { name: 'Budget.xlsx', type: 'file' },
                { name: 'Notes', type: 'folder' }
            ],
            pictures: [
                { name: 'vacation.jpg', type: 'file' },
                { name: 'family.png', type: 'file' },
                { name: 'screenshot.jpg', type: 'file' }
            ],
            music: [
                { name: 'song1.mp3', type: 'file' },
                { name: 'song2.mp3', type: 'file' }
            ],
            video: [
                { name: 'video.mp4', type: 'file' },
                { name: 'movie.mkv', type: 'file' }
            ],
            thispc: [
                { name: 'C:', type: 'drive' },
                { name: 'D:', type: 'drive' }
            ]
        };

        function navigateExplorer(location, element) {
            document.querySelectorAll('.explorer-sidebar-item').forEach(el => el.classList.remove('active'));
            if (element) element.classList.add('active');
            
            const pathText = document.getElementById('explorer-path-text');
            const content = document.getElementById('explorer-content');
            
            const pathNames = {
                desktop: 'Desktop',
                downloads: 'Downloads',
                documents: 'Documents',
                pictures: 'Pictures',
                music: 'Music',
                video: 'Videos',
                thispc: 'This PC'
            };
            
            pathText.textContent = 'This PC > ' + pathNames[location];
            
            const items = explorerData[location] || [];
            content.innerHTML = items.map(item => `
                <div class="file-item">
                    <div class="file-icon">
                        ${getFileIcon(item.type)}
                    </div>
                    <div class="file-name">${item.name}</div>
                </div>
            `).join('');
        }

        function getFileIcon(type) {
            const icons = {
                folder: '<svg width="48" height="48" viewBox="0 0 48 48"><rect x="4" y="10" width="20" height="28" rx="2" fill="#f0c33c"/><rect x="20" y="6" width="24" height="32" rx="2" fill="#f0c33c"/></svg>',
                file: '<svg width="48" height="48" viewBox="0 0 48 48"><rect x="10" y="6" width="28" height="36" rx="2" fill="#60a5fa"/><text x="24" y="28" fill="white" font-size="8" font-weight="bold" text-anchor="middle" font-family="Arial">FILE</text></svg>',
                drive: '<svg width="48" height="48" viewBox="0 0 48 48"><rect x="6" y="8" width="36" height="32" rx="3" fill="#888"/><rect x="10" y="12" width="28" height="20" fill="#333"/><circle cx="24" cy="22" r="4" fill="#60a5fa"/></svg>'
            };
            return icons[type] || icons.file;
        }

        // Excel Table Generator
        function generateExcelTable() {
            let html = '<tr><td style="width: 50px; background: #f3f3f3; border: 1px solid #ddd; padding: 4px;"></td>';
            for (let i = 0; i < 5; i++) {
                html += `<td style="width: 100px; background: #f3f3f3; border: 1px solid #ddd; padding: 4px; font-weight: 600; text-align: center;">${String.fromCharCode(65 + i)}</td>`;
            }
            html += '</tr>';
            
            for (let row = 1; row <= 10; row++) {
                html += `<tr><td style="background: #f3f3f3; border: 1px solid #ddd; padding: 4px; text-align: center;">${row}</td>`;
                for (let col = 0; col < 5; col++) {
                    const cellId = String.fromCharCode(65 + col) + row;
                    const value = getExcelCellValue(cellId);
                    html += `<td style="border: 1px solid #ddd; padding: 4px; min-width: 100px;" contenteditable="true" onblur="updateExcelCell('${cellId}', this)">${value}</td>`;
                }
                html += '</tr>';
            }
            return html;
        }

        function getExcelCellValue(cellId) {
            const data = {
                'A1': 'Product',
                'B1': 'Qty',
                'C1': 'Price',
                'D1': 'Total',
                'A2': 'Apple',
                'B2': '10',
                'C2': '1.50',
                'A3': 'Banana',
                'B3': '20',
                'C3': '0.75'
            };
            return data[cellId] || '';
        }

        function updateExcelCell(cellId, element) {
            // Simple calculation for D column
            if (cellId.startsWith('D')) {
                const row = cellId.substring(1);
                const qty = document.querySelector(`td[data-cell="B${row}"]`)?.textContent || 0;
                const price = document.querySelector(`td[data-cell="C${row}"]`)?.textContent || 0;
                if (qty && price) {
                    const total = (parseFloat(qty) * parseFloat(price)).toFixed(2);
                    // This would update the total cell in a real implementation
                }
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.getElementById('start-menu').classList.remove('active');
                document.getElementById('context-menu').style.display = 'none';
            }
        });

        // Double click to open apps from taskbar
        document.querySelectorAll('.taskbar-icon').forEach(icon => {
            icon.addEventListener('dblclick', () => {
                const title = icon.getAttribute('title');
                if (title) {
                    const appMap = {
                        'File Explorer': 'explorer',
                        'Chrome': 'chrome',
                        'Word': 'word'
                    };
                    if (appMap[title]) openApp(appMap[title]);
                }
            });
        });
    </script>
</body>
</html>