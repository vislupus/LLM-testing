<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Windows 11</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;user-select:none;}
:root{
  --accent:#0078d4;--surface:rgba(255,255,255,0.92);--surface-solid:#fff;
  --bg:#f3f3f3;--text:#1a1a1a;--text2:#606060;--border:#e5e5e5;
  --hover:rgba(0,0,0,0.04);--active:rgba(0,0,0,0.06);
  --shadow:0 8px 32px rgba(0,0,0,0.18),0 0 1px rgba(0,0,0,0.1);
  --tb-h:48px;--radius:8px;
}
body{font-family:'Segoe UI Variable','Segoe UI',system-ui,sans-serif;overflow:hidden;width:100vw;height:100vh;}

/* ============ WALLPAPER ============ */
#wallpaper{
  position:fixed;inset:0;z-index:0;
  background:
    radial-gradient(ellipse 120% 80% at 50% 130%, rgba(0,120,215,0.9) 0%, transparent 55%),
    radial-gradient(ellipse 50% 45% at 25% 95%, rgba(180,74,237,0.7) 0%, transparent 50%),
    radial-gradient(ellipse 45% 40% at 75% 100%, rgba(0,183,195,0.6) 0%, transparent 45%),
    radial-gradient(ellipse 35% 30% at 60% 85%, rgba(100,200,255,0.4) 0%, transparent 40%),
    radial-gradient(ellipse 30% 25% at 40% 75%, rgba(200,100,255,0.3) 0%, transparent 40%),
    linear-gradient(180deg, #070b34 0%, #0a1628 30%, #0d1f3c 50%, #0f1a30 70%, #060e20 100%);
}

/* ============ DESKTOP ICONS ============ */
#desktop{
  position:fixed;inset:0;bottom:var(--tb-h);z-index:1;
  padding:12px 8px;display:flex;flex-direction:column;flex-wrap:wrap;
  align-content:flex-start;gap:2px;
}
.di{
  width:74px;display:flex;flex-direction:column;align-items:center;
  padding:8px 4px 6px;border-radius:4px;cursor:pointer;gap:2px;
  transition:background .15s;
}
.di:hover{background:rgba(255,255,255,0.12);}
.di:active{background:rgba(255,255,255,0.06);}
.di .di-icon{width:44px;height:44px;pointer-events:none;filter:drop-shadow(0 1px 2px rgba(0,0,0,0.4));}
.di span{color:#fff;font-size:11px;text-align:center;line-height:1.25;
  text-shadow:0 1px 4px rgba(0,0,0,0.8),0 0 2px rgba(0,0,0,0.5);
  max-width:72px;word-wrap:break-word;}

/* ============ TASKBAR ============ */
#taskbar{
  position:fixed;bottom:0;left:0;right:0;height:var(--tb-h);
  background:rgba(243,243,243,0.82);backdrop-filter:blur(60px) saturate(180%);
  -webkit-backdrop-filter:blur(60px) saturate(180%);
  border-top:1px solid rgba(255,255,255,0.7);
  display:flex;align-items:center;justify-content:center;z-index:1000;gap:1px;
}
.tb-btn{
  width:40px;height:38px;display:flex;align-items:center;justify-content:center;
  border-radius:4px;cursor:pointer;transition:background .12s;position:relative;
}
.tb-btn:hover{background:var(--hover);}
.tb-btn:active{background:var(--active);}
.tb-btn img,.tb-btn svg{width:22px;height:22px;}
.tb-btn.active::after,.tb-btn.has-win::after{
  content:'';position:absolute;bottom:1px;left:50%;transform:translateX(-50%);
  height:3px;border-radius:2px;
}
.tb-btn.active::after{width:16px;background:var(--accent);}
.tb-btn.has-win:not(.active)::after{width:6px;background:#999;}
#tb-right{
  position:absolute;right:0;display:flex;align-items:center;
  font-size:11.5px;color:#333;padding:6px 14px;gap:2px;
  border-radius:4px;cursor:pointer;text-align:right;line-height:1.3;
}
#tb-right:hover{background:var(--hover);}

/* ============ WINDOWS ============ */
.win{
  position:fixed;background:var(--surface-solid);border-radius:var(--radius);
  box-shadow:var(--shadow);border:1px solid rgba(0,0,0,0.06);
  display:flex;flex-direction:column;overflow:hidden;z-index:10;
  min-width:360px;min-height:260px;
}
.win.maximized{top:0!important;left:0!important;width:100vw!important;
  height:calc(100vh - var(--tb-h))!important;border-radius:0;
}
.win-titlebar{
  height:34px;background:var(--surface-solid);display:flex;align-items:center;
  justify-content:space-between;padding-left:14px;flex-shrink:0;cursor:default;
}
.win-titlebar .wt{font-size:12px;color:var(--text);display:flex;align-items:center;gap:8px;}
.win-titlebar .wt img{width:16px;height:16px;}
.win-ctrls{display:flex;height:100%;}
.wc{
  width:46px;height:100%;display:flex;align-items:center;justify-content:center;
  cursor:pointer;transition:background .1s;
}
.wc:hover{background:rgba(0,0,0,0.04);}
.wc.wc-close:hover{background:#c42b1c;}
.wc.wc-close:hover svg path{stroke:#fff;}
.wc svg{width:10px;height:10px;}
.wc svg path{stroke:#444;stroke-width:1;fill:none;}
.win-body{flex:1;overflow:auto;background:var(--bg);position:relative;}
.win .resize{position:absolute;bottom:0;right:0;width:14px;height:14px;cursor:nwse-resize;}

/* ============ NOTEPAD ============ */
.np-menu{display:flex;gap:0;padding:0 6px;background:var(--surface-solid);border-bottom:1px solid var(--border);font-size:12.5px;}
.np-menu span{padding:4px 10px;cursor:pointer;border-radius:4px;}
.np-menu span:hover{background:var(--hover);}
.np-area{flex:1;display:flex;}
.np-area textarea{
  width:100%;height:100%;border:none;resize:none;padding:4px 12px;
  font-family:Consolas,'Courier New',monospace;font-size:14px;line-height:1.5;
  outline:none;background:#fff;color:#1a1a1a;
}

/* ============ CALCULATOR ============ */
.calc-wrap{display:flex;flex-direction:column;height:100%;background:#f0f0f0;padding:6px;gap:3px;}
.calc-disp{
  text-align:right;padding:8px 16px;font-size:42px;font-weight:200;
  color:var(--text);min-height:80px;display:flex;flex-direction:column;
  align-items:flex-end;justify-content:flex-end;
}
.calc-disp .ch{font-size:13px;color:var(--text2);min-height:18px;}
.calc-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:3px;flex:1;}
.cb{
  border:none;border-radius:4px;font-size:15.5px;cursor:pointer;
  background:var(--surface-solid);color:var(--text);transition:background .1s;
  font-family:inherit;display:flex;align-items:center;justify-content:center;
}
.cb:hover{background:#e6e6e6;}
.cb:active{background:#d5d5d5;transform:scale(0.97);}
.cb.op{background:#f7f7f7;font-size:17px;}
.cb.eq{background:var(--accent);color:#fff;font-size:18px;}
.cb.eq:hover{background:#106ebe;}

/* ============ PAINT ============ */
.pt-bar{
  display:flex;align-items:center;gap:6px;padding:5px 10px;
  background:var(--surface-solid);border-bottom:1px solid var(--border);flex-wrap:wrap;
}
.pt-bar label{font-size:11px;color:var(--text2);}
.pt-bar input[type=color]{width:26px;height:26px;border:1px solid var(--border);border-radius:4px;cursor:pointer;padding:1px;}
.pt-bar input[type=range]{width:70px;accent-color:var(--accent);}
.pt-btn{
  padding:3px 8px;border:1px solid var(--border);border-radius:4px;
  background:var(--surface-solid);cursor:pointer;font-size:11.5px;font-family:inherit;
}
.pt-btn:hover{background:var(--hover);}
.pt-btn.active{background:#cce4f7;border-color:var(--accent);}
.pt-colors{display:flex;gap:2px;align-items:center;}
.pt-color-swatch{width:18px;height:18px;border-radius:3px;cursor:pointer;border:1px solid rgba(0,0,0,0.15);}
.pt-color-swatch:hover{transform:scale(1.15);}
.pt-wrap{flex:1;overflow:auto;background:#808080;padding:4px;display:flex;align-items:flex-start;}
.pt-wrap canvas{background:#fff;cursor:crosshair;box-shadow:0 2px 8px rgba(0,0,0,0.25);}

/* ============ WORD ============ */
.wd-tabs{display:flex;background:#2b579a;padding:0 8px;font-size:12px;}
.wd-tab{padding:6px 14px;color:rgba(255,255,255,0.8);cursor:pointer;border-radius:4px 4px 0 0;}
.wd-tab:hover{color:#fff;}
.wd-tab.active{background:var(--surface-solid);color:#2b579a;}
.wd-ribbon{
  display:flex;align-items:center;gap:3px;padding:4px 10px;
  background:var(--surface-solid);border-bottom:1px solid var(--border);flex-wrap:wrap;
}
.wd-ribbon select,.wd-ribbon button{
  padding:3px 7px;border:1px solid var(--border);border-radius:3px;
  background:var(--surface-solid);cursor:pointer;font-size:12px;font-family:inherit;
}
.wd-ribbon button:hover{background:var(--hover);}
.wd-ribbon .sep{width:1px;height:22px;background:var(--border);margin:0 3px;}
.wd-area{flex:1;display:flex;justify-content:center;padding:20px;background:#e8e8e8;overflow:auto;}
.wd-page{
  width:660px;min-height:860px;background:#fff;
  box-shadow:0 1px 6px rgba(0,0,0,0.1);padding:72px 72px;
  outline:none;font-size:14px;line-height:1.65;color:#1a1a1a;
}

/* ============ FILE EXPLORER ============ */
.ex-wrap{display:flex;height:100%;background:var(--surface-solid);}
.ex-side{
  width:190px;background:var(--surface-solid);border-right:1px solid var(--border);
  padding:6px 0;overflow-y:auto;flex-shrink:0;
}
.ex-si{
  padding:5px 14px;font-size:12.5px;cursor:pointer;display:flex;
  align-items:center;gap:8px;color:var(--text);
}
.ex-si:hover{background:var(--hover);}
.ex-si.active{background:rgba(0,120,215,0.08);}
.ex-main{flex:1;display:flex;flex-direction:column;}
.ex-path{
  padding:5px 10px;background:var(--surface-solid);border-bottom:1px solid var(--border);
  font-size:12px;display:flex;align-items:center;gap:6px;
}
.ex-path input{
  flex:1;border:1px solid var(--border);border-radius:4px;padding:4px 8px;
  font-size:12px;font-family:inherit;outline:none;background:var(--bg);
}
.ex-back{
  padding:2px 8px;border:none;background:none;cursor:pointer;
  font-size:14px;border-radius:4px;color:var(--text);
}
.ex-back:hover{background:var(--hover);}
.ex-content{
  flex:1;padding:8px;display:flex;flex-wrap:wrap;gap:2px;
  align-content:flex-start;overflow-y:auto;
}
.ex-item{
  width:78px;display:flex;flex-direction:column;align-items:center;
  padding:6px 4px;border-radius:4px;cursor:pointer;gap:3px;
}
.ex-item:hover{background:var(--hover);}
.ex-item.sel{background:rgba(0,120,215,0.1);}
.ex-item .exi{font-size:30px;}
.ex-item span{font-size:11px;text-align:center;color:var(--text);word-break:break-word;line-height:1.2;}

/* ============ CHROME ============ */
.cr-tabs{display:flex;align-items:flex-end;background:#dee1e6;padding:6px 8px 0;gap:1px;height:34px;}
.cr-tab{
  padding:5px 14px;background:var(--surface-solid);border-radius:8px 8px 0 0;
  font-size:12px;cursor:pointer;display:flex;align-items:center;gap:6px;color:#444;
}
.cr-bar{
  display:flex;align-items:center;gap:6px;padding:5px 10px;
  background:var(--surface-solid);border-bottom:1px solid var(--border);
}
.cr-nav{
  width:28px;height:28px;border:none;background:none;border-radius:50%;
  cursor:pointer;display:flex;align-items:center;justify-content:center;
  font-size:15px;color:#5f6368;
}
.cr-nav:hover{background:#f1f3f4;}
.cr-url{
  flex:1;padding:6px 14px;border-radius:20px;border:1px solid #dfe1e5;
  background:#f1f3f4;font-size:13px;font-family:inherit;outline:none;
}
.cr-url:focus{background:#fff;border-color:var(--accent);box-shadow:0 0 0 2px rgba(0,120,215,0.15);}
.cr-body{
  flex:1;display:flex;flex-direction:column;align-items:center;
  padding-top:80px;background:#fff;overflow-y:auto;
}
.cr-logo{width:100px;height:100px;margin-bottom:28px;}
.cr-search{
  width:520px;max-width:90%;padding:12px 20px;border:1px solid #dfe1e5;
  border-radius:24px;font-size:15px;font-family:inherit;outline:none;
  box-shadow:0 1px 6px rgba(32,33,36,0.08);
}
.cr-search:hover{box-shadow:0 2px 8px rgba(32,33,36,0.14);}
.cr-search:focus{box-shadow:0 2px 8px rgba(32,33,36,0.2);border-color:transparent;}
.cr-shortcuts{display:flex;gap:12px;margin-top:28px;flex-wrap:wrap;justify-content:center;}
.cr-sc{
  width:88px;display:flex;flex-direction:column;align-items:center;gap:6px;
  padding:10px;border-radius:8px;cursor:pointer;
}
.cr-sc:hover{background:#f1f3f4;}
.cr-sc-i{
  width:44px;height:44px;background:#f1f3f4;border-radius:50%;
  display:flex;align-items:center;justify-content:center;font-size:18px;
}
.cr-sc span{font-size:11.5px;color:#202124;}

/* ============ START MENU ============ */
#startmenu{
  position:fixed;bottom:calc(var(--tb-h) + 12px);left:50%;transform:translateX(-50%);
  width:580px;background:rgba(252,252,252,0.94);backdrop-filter:blur(40px);
  border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid rgba(0,0,0,0.06);
  z-index:2000;display:none;flex-direction:column;padding:32px 32px 16px;
}
#startmenu.open{display:flex;animation:sUp .18s ease;}
@keyframes sUp{from{opacity:0;transform:translateX(-50%) translateY(16px);}to{opacity:1;transform:translateX(-50%) translateY(0);}}
.sm-search{
  width:100%;padding:8px 14px 8px 34px;border:1px solid var(--border);
  border-radius:20px;font-size:13px;font-family:inherit;outline:none;
  background:var(--bg) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='13' height='13' fill='none' stroke='%23888' stroke-width='2' viewBox='0 0 24 24'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'/%3E%3C/svg%3E") 11px center no-repeat;
  margin-bottom:22px;
}
.sm-title{font-size:13.5px;font-weight:600;color:var(--text);margin-bottom:10px;}
.sm-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:2px;margin-bottom:16px;}
.sm-item{
  display:flex;flex-direction:column;align-items:center;padding:10px 4px;
  border-radius:4px;cursor:pointer;gap:4px;
}
.sm-item:hover{background:var(--hover);}
.sm-item img{width:30px;height:30px;}
.sm-item span{font-size:11px;color:var(--text);text-align:center;}
.sm-user{
  display:flex;align-items:center;gap:10px;padding:10px 6px;
  border-top:1px solid var(--border);margin-top:auto;
}
.sm-avatar{width:32px;height:32px;border-radius:50%;background:var(--accent);
  display:flex;align-items:center;justify-content:center;color:#fff;font-size:14px;font-weight:600;}
.sm-username{font-size:13px;color:var(--text);}

/* ============ CONTEXT MENU ============ */
#ctxmenu{
  position:fixed;background:rgba(252,252,252,0.96);backdrop-filter:blur(20px);
  border:1px solid rgba(0,0,0,0.06);border-radius:var(--radius);
  box-shadow:var(--shadow);padding:4px;z-index:9999;min-width:220px;display:none;
}
#ctxmenu.open{display:block;}
.ctx-i{
  padding:7px 24px 7px 12px;font-size:12px;cursor:pointer;border-radius:4px;
  color:var(--text);display:flex;align-items:center;gap:10px;
}
.ctx-i:hover{background:var(--hover);}
.ctx-sep{height:1px;background:var(--border);margin:3px 8px;}
</style>
</head>
<body>
<div id="wallpaper"></div>
<div id="desktop"></div>

<div id="taskbar">
  <div id="tb-center"></div>
  <div id="tb-right"><div id="clk"></div></div>
</div>

<div id="startmenu">
  <input class="sm-search" placeholder="Type here to search">
  <div class="sm-title">Pinned</div>
  <div class="sm-grid" id="sm-grid"></div>
  <div class="sm-user"><div class="sm-avatar">U</div><div class="sm-username">User</div></div>
</div>

<div id="ctxmenu">
  <div class="ctx-i" onclick="hideCtx()">üîÑ &nbsp;Refresh</div>
  <div class="ctx-sep"></div>
  <div class="ctx-i" onclick="hideCtx()">üìã &nbsp;Paste</div>
  <div class="ctx-i" onclick="hideCtx()">üñ•Ô∏è &nbsp;Display settings</div>
  <div class="ctx-i" onclick="hideCtx()">üé® &nbsp;Personalize</div>
  <div class="ctx-sep"></div>
  <div class="ctx-i" onclick="hideCtx()">üìÇ &nbsp;Open in Terminal</div>
  <div class="ctx-i" onclick="hideCtx()">‚ÑπÔ∏è &nbsp;Properties</div>
</div>

<script>
// ===================== SVG ICONS =====================
const SVG={
word:`<svg viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg">
<defs><linearGradient id="wg1" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#2b7cd3"/><stop offset="1" stop-color="#185abd"/></linearGradient>
<linearGradient id="wg2" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#41a5ee"/><stop offset="1" stop-color="#2b7cd3"/></linearGradient></defs>
<rect x="28" y="8" width="56" height="80" rx="4" fill="#fff"/>
<path d="M28 12a4 4 0 014-4h48a4 4 0 014 4v72a4 4 0 01-4 4H32a4 4 0 01-4-4z" fill="#fff"/>
<line x1="38" y1="28" x2="74" y2="28" stroke="#c8d8e8" stroke-width="1.5"/>
<line x1="38" y1="38" x2="74" y2="38" stroke="#c8d8e8" stroke-width="1.5"/>
<line x1="38" y1="48" x2="74" y2="48" stroke="#c8d8e8" stroke-width="1.5"/>
<line x1="38" y1="58" x2="64" y2="58" stroke="#c8d8e8" stroke-width="1.5"/>
<line x1="38" y1="68" x2="58" y2="68" stroke="#c8d8e8" stroke-width="1.5"/>
<rect x="8" y="20" width="44" height="56" rx="4" fill="url(#wg1)"/>
<path d="M12 20h36a4 4 0 014 4v48a4 4 0 01-4 4H12a4 4 0 01-4-4V24a4 4 0 014-4z" fill="url(#wg2)" opacity="0.35"/>
<text x="30" y="56" font-family="Segoe UI,sans-serif" font-weight="bold" font-size="28" fill="white" text-anchor="middle">W</text>
</svg>`,

paint:`<svg viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg">
<rect x="12" y="20" width="72" height="64" rx="6" fill="#fff" stroke="#e0e0e0" stroke-width="1.5"/>
<rect x="18" y="32" width="60" height="46" rx="2" fill="#f8f8f8"/>
<rect x="18" y="20" width="60" height="10" rx="2" fill="#f0f0f0"/>
<circle cx="28" cy="50" r="8" fill="#ef4444"/>
<circle cx="50" cy="42" r="10" fill="#3b82f6"/>
<circle cx="68" cy="56" r="7" fill="#22c55e"/>
<ellipse cx="42" cy="64" rx="12" ry="6" fill="#eab308"/>
<path d="M20 12l8 8M18 8c0 0 4-4 10-2s6 6 6 6" stroke="#f97316" stroke-width="3" fill="none" stroke-linecap="round"/>
<circle cx="18" cy="8" r="3" fill="#f97316"/>
</svg>`,

calc:`<svg viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg">
<rect x="18" y="8" width="60" height="80" rx="8" fill="#202020"/>
<rect x="24" y="16" width="48" height="20" rx="4" fill="#2d2d2d"/>
<text x="66" y="32" font-family="Segoe UI,sans-serif" font-size="16" font-weight="300" fill="#7ecbff" text-anchor="end">0</text>
<g fill="#3a3a3a"><rect x="24" y="42" width="10" height="9" rx="2"/><rect x="37" y="42" width="10" height="9" rx="2"/>
<rect x="50" y="42" width="10" height="9" rx="2"/><rect x="63" y="42" width="10" height="9" rx="2.5" fill="#ff9f0a"/>
<rect x="24" y="54" width="10" height="9" rx="2"/><rect x="37" y="54" width="10" height="9" rx="2"/>
<rect x="50" y="54" width="10" height="9" rx="2"/><rect x="63" y="54" width="10" height="9" rx="2.5" fill="#ff9f0a"/>
<rect x="24" y="66" width="10" height="9" rx="2"/><rect x="37" y="66" width="10" height="9" rx="2"/>
<rect x="50" y="66" width="10" height="9" rx="2"/><rect x="63" y="66" width="10" height="9" rx="2.5" fill="#ff9f0a"/>
<rect x="24" y="78" width="23" height="9" rx="2"/><rect x="50" y="78" width="10" height="9" rx="2"/>
<rect x="63" y="78" width="10" height="9" rx="2.5" fill="#0078d4"/></g>
</svg>`,

notepad:`<svg viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg">
<defs><linearGradient id="ng" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#4fc3f7"/><stop offset="1" stop-color="#0288d1"/></linearGradient></defs>
<path d="M24 8h48a6 6 0 016 6v68a6 6 0 01-6 6H24a6 6 0 01-6-6V14a6 6 0 016-6z" fill="url(#ng)"/>
<rect x="26" y="18" width="44" height="60" rx="2" fill="#fff"/>
<line x1="32" y1="30" x2="64" y2="30" stroke="#dbeafe" stroke-width="1.2"/>
<line x1="32" y1="38" x2="64" y2="38" stroke="#dbeafe" stroke-width="1.2"/>
<line x1="32" y1="46" x2="64" y2="46" stroke="#dbeafe" stroke-width="1.2"/>
<line x1="32" y1="54" x2="56" y2="54" stroke="#dbeafe" stroke-width="1.2"/>
<line x1="32" y1="62" x2="48" y2="62" stroke="#dbeafe" stroke-width="1.2"/>
<rect x="38" y="4" width="4" height="10" rx="1" fill="#555"/>
<rect x="50" y="4" width="4" height="10" rx="1" fill="#555"/>
</svg>`,

explorer:`<svg viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg">
<defs><linearGradient id="eg" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="#ffd54f"/><stop offset="1" stop-color="#ffb300"/></linearGradient></defs>
<path d="M10 28l6-10h20l6 10h40a4 4 0 014 4v44a4 4 0 01-4 4H14a4 4 0 01-4-4V28z" fill="url(#eg)"/>
<rect x="10" y="34" width="76" height="42" rx="3" fill="#ffc107"/>
<rect x="10" y="34" width="76" height="10" fill="rgba(255,255,255,0.25)" rx="3"/>
</svg>`,

chrome:`<svg viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg">
<circle cx="48" cy="48" r="40" fill="#fff"/>
<path d="M48 8a40 40 0 0134.64 20H48z" fill="#ea4335"/>
<path d="M82.64 28A40 40 0 0148 88l17.32-30z" fill="#4285f4"/>
<path d="M48 88A40 40 0 0113.36 28L30.68 58z" fill="#34a853"/>
<path d="M13.36 28L48 28 30.68 58z" fill="#fbbc04"/>
<circle cx="48" cy="48" r="16" fill="#fff"/>
<circle cx="48" cy="48" r="12" fill="#4285f4"/>
</svg>`,

windows:`<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M3 5.5l7.07-.97v6.87H3V5.5zm0 12.96l7.07.97v-6.87H3v5.9zm7.93 1.08L21 21V12.56H10.93v6.98zM21 3L10.93 4.47v6.09H21V3z" fill="#0078d4"/>
</svg>`
};

function svgUrl(k){return 'data:image/svg+xml,'+encodeURIComponent(SVG[k]);}

// ===================== APPS =====================
const APPS=[
  {id:'word',name:'Microsoft Word',icon:'word',w:780,h:560},
  {id:'paint',name:'Paint',icon:'paint',w:820,h:560},
  {id:'calc',name:'Calculator',icon:'calc',w:320,h:500},
  {id:'notepad',name:'Notepad',icon:'notepad',w:660,h:460},
  {id:'explorer',name:'File Explorer',icon:'explorer',w:820,h:500},
  {id:'chrome',name:'Google Chrome',icon:'chrome',w:920,h:620},
];

let zIdx=10,openWins={},activeWin=null;

// ===================== CLOCK =====================
function tick(){
  const n=new Date();
  document.getElementById('clk').innerHTML=
    n.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})+'<br>'+
    n.toLocaleDateString([],{month:'numeric',day:'numeric',year:'numeric'});
}
tick();setInterval(tick,1000);

// ===================== DESKTOP ICONS =====================
const desk=document.getElementById('desktop');
APPS.forEach(a=>{
  const d=document.createElement('div');d.className='di';
  d.innerHTML=`<img class="di-icon" src="${svgUrl(a.icon)}"><span>${a.name}</span>`;
  d.ondblclick=()=>openApp(a.id);
  desk.appendChild(d);
});

// ===================== TASKBAR =====================
const tbc=document.getElementById('tb-center');
const sb=document.createElement('div');sb.className='tb-btn';
sb.innerHTML=`<img src="${svgUrl('windows')}">`;sb.onclick=toggleStart;
tbc.appendChild(sb);
const sep=document.createElement('div');sep.style.cssText='width:1px;height:18px;background:#ccc;margin:0 4px;';
tbc.appendChild(sep);
APPS.forEach(a=>{
  const b=document.createElement('div');b.className='tb-btn';b.id='tb-'+a.id;
  b.innerHTML=`<img src="${svgUrl(a.icon)}" title="${a.name}">`;
  b.onclick=()=>{
    if(openWins[a.id]){
      const w=document.getElementById('w-'+a.id);
      if(activeWin===a.id){w.style.display=w.style.display==='none'?'flex':'none';}
      else{w.style.display='flex';focus(a.id);}
    }else openApp(a.id);
  };
  tbc.appendChild(b);
});

// ===================== START MENU =====================
const smg=document.getElementById('sm-grid');
APPS.forEach(a=>{
  const i=document.createElement('div');i.className='sm-item';
  const short=a.name.includes(' ')?a.name.split(' ').pop():a.name;
  i.innerHTML=`<img src="${svgUrl(a.icon)}"><span>${short}</span>`;
  i.onclick=()=>{openApp(a.id);toggleStart();};
  smg.appendChild(i);
});
function toggleStart(){document.getElementById('startmenu').classList.toggle('open');}

// ===================== CONTEXT MENU =====================
desk.addEventListener('contextmenu',e=>{
  e.preventDefault();const c=document.getElementById('ctxmenu');
  c.style.left=Math.min(e.clientX,innerWidth-240)+'px';
  c.style.top=Math.min(e.clientY,innerHeight-260)+'px';
  c.classList.add('open');
});
function hideCtx(){document.getElementById('ctxmenu').classList.remove('open');}
document.addEventListener('click',e=>{
  hideCtx();
  if(!e.target.closest('#startmenu')&&!e.target.closest('.tb-btn'))
    document.getElementById('startmenu').classList.remove('open');
});

// ===================== WINDOW SYSTEM =====================
function mkWin(app){
  const w=document.createElement('div');w.className='win';w.id='w-'+app.id;
  w.style.width=app.w+'px';w.style.height=app.h+'px';
  const cx=innerWidth/2-app.w/2+~~(Math.random()*60-30);
  const cy=innerHeight/2-app.h/2-30+~~(Math.random()*40-20);
  w.style.left=Math.max(0,cx)+'px';w.style.top=Math.max(0,cy)+'px';
  w.style.zIndex=++zIdx;
  w.innerHTML=`
    <div class="win-titlebar" data-id="${app.id}">
      <div class="wt"><img src="${svgUrl(app.icon)}">${app.name}</div>
      <div class="win-ctrls">
        <div class="wc" onclick="minimize('${app.id}')"><svg viewBox="0 0 10 10"><path d="M0 5h10"/></svg></div>
        <div class="wc" onclick="maximize('${app.id}')"><svg viewBox="0 0 10 10"><rect x=".5" y=".5" width="9" height="9" rx="1.5"/></svg></div>
        <div class="wc wc-close" onclick="closeWin('${app.id}')"><svg viewBox="0 0 10 10"><path d="M1 1l8 8M9 1L1 9"/></svg></div>
      </div>
    </div>
    <div class="win-body" id="b-${app.id}"></div>
    <div class="resize" data-id="${app.id}"></div>`;
  w.onmousedown=()=>focus(app.id);
  document.body.appendChild(w);
  drag(w,w.querySelector('.win-titlebar'));
  resizeHandle(w,w.querySelector('.resize'));
  return w;
}

function drag(w,h){
  h.addEventListener('mousedown',e=>{
    if(e.target.closest('.win-ctrls')||w.classList.contains('maximized'))return;
    let sx=e.clientX,sy=e.clientY,sl=w.offsetLeft,st=w.offsetTop,d=true;
    const mv=e2=>{if(d){w.style.left=(sl+e2.clientX-sx)+'px';w.style.top=(st+e2.clientY-sy)+'px';}};
    const up=()=>{d=false;document.removeEventListener('mousemove',mv);document.removeEventListener('mouseup',up);};
    document.addEventListener('mousemove',mv);document.addEventListener('mouseup',up);
  });
}
function resizeHandle(w,h){
  h.addEventListener('mousedown',e=>{
    if(w.classList.contains('maximized'))return;
    let sx=e.clientX,sy=e.clientY,sw=w.offsetWidth,sh=w.offsetHeight;e.stopPropagation();
    const mv=e2=>{w.style.width=Math.max(360,sw+e2.clientX-sx)+'px';w.style.height=Math.max(260,sh+e2.clientY-sy)+'px';};
    const up=()=>{document.removeEventListener('mousemove',mv);document.removeEventListener('mouseup',up);};
    document.addEventListener('mousemove',mv);document.addEventListener('mouseup',up);
  });
}
function focus(id){
  const w=document.getElementById('w-'+id);if(!w)return;
  w.style.zIndex=++zIdx;activeWin=id;
  document.querySelectorAll('.tb-btn').forEach(b=>b.classList.remove('active'));
  const tb=document.getElementById('tb-'+id);
  if(tb){tb.classList.add('active');tb.classList.add('has-win');}
}
function minimize(id){
  const w=document.getElementById('w-'+id);if(w)w.style.display='none';
  if(activeWin===id)activeWin=null;
  document.getElementById('tb-'+id)?.classList.remove('active');
}
function maximize(id){document.getElementById('w-'+id)?.classList.toggle('maximized');}
function closeWin(id){
  document.getElementById('w-'+id)?.remove();delete openWins[id];
  const tb=document.getElementById('tb-'+id);if(tb){tb.classList.remove('active','has-win');}
  if(activeWin===id)activeWin=null;
}
function openApp(id){
  if(openWins[id]){const w=document.getElementById('w-'+id);w.style.display='flex';focus(id);return;}
  const app=APPS.find(a=>a.id===id);mkWin(app);openWins[id]=true;
  const body=document.getElementById('b-'+id);
  ({notepad:buildNotepad,calc:buildCalc,paint:buildPaint,word:buildWord,explorer:buildExplorer,chrome:buildChrome})[id](body);
  focus(id);
}

// ===================== NOTEPAD =====================
function buildNotepad(b){
  b.style.cssText='display:flex;flex-direction:column;height:100%';
  b.innerHTML=`<div class="np-menu"><span>File</span><span>Edit</span><span>Format</span><span>View</span><span>Help</span></div>
  <div class="np-area"><textarea spellcheck="false" placeholder="Type something here..."></textarea></div>`;
}

// ===================== CALCULATOR =====================
function buildCalc(b){
  b.style.cssText='display:flex;flex-direction:column;height:100%';
  let disp='0',hist='',op=null,prev=null,rst=false;
  const btns=[['%','CE','C','‚å´'],['‚Öüx','x¬≤','‚àö','√∑'],['7','8','9','√ó'],['4','5','6','‚àí'],['1','2','3','+'],['¬±','0','.','=']];
  b.innerHTML=`<div class="calc-wrap"><div class="calc-disp"><div class="ch" id="ch"></div><div id="cv">0</div></div><div class="calc-grid" id="cg"></div></div>`;
  const g=b.querySelector('#cg'),vEl=b.querySelector('#cv'),hEl=b.querySelector('#ch');
  btns.flat().forEach(l=>{
    const btn=document.createElement('button');btn.className='cb';btn.textContent=l;
    if('√∑√ó‚àí+'.includes(l))btn.classList.add('op');
    if(l==='=')btn.classList.add('eq');
    btn.onclick=()=>press(l);g.appendChild(btn);
  });
  function press(l){
    if('0123456789'.includes(l)){if(disp==='0'||rst){disp=l;rst=false;}else disp+=l;}
    else if(l==='.'){if(rst){disp='0.';rst=false;}else if(!disp.includes('.'))disp+='.';}
    else if(l==='C'){disp='0';hist='';op=null;prev=null;}
    else if(l==='CE')disp='0';
    else if(l==='‚å´')disp=disp.length>1?disp.slice(0,-1):'0';
    else if(l==='¬±')disp=disp.startsWith('-')?disp.slice(1):'-'+disp;
    else if(l==='x¬≤'){disp=String(Math.pow(+disp,2));rst=true;}
    else if(l==='‚àö'){disp=String(Math.sqrt(+disp));rst=true;}
    else if(l==='‚Öüx'){disp=String(1/+disp);rst=true;}
    else if(l==='%'){if(prev!==null)disp=String(prev*(+disp/100));else disp=String(+disp/100);rst=true;}
    else if('+-‚àí√ó√∑'.includes(l)){
      if(prev!==null&&op&&!rst)calc();
      prev=+disp;op=l;hist=disp+' '+l;rst=true;
    }else if(l==='='){
      if(prev!==null&&op){hist=prev+' '+op+' '+disp+' =';calc();op=null;prev=null;}
    }
    // Format display
    let shown=disp;
    if(!isNaN(+disp)&&disp!=='Error'&&!disp.includes('.')){
      const n=+disp;
      if(Math.abs(n)<1e15)shown=n.toLocaleString();
    }
    vEl.textContent=shown;hEl.textContent=hist;
  }
  function calc(){
    const c=+disp;let r=prev;
    if(op==='+')r=prev+c;else if(op==='‚àí')r=prev-c;
    else if(op==='√ó')r=prev*c;else if(op==='√∑')r=c?prev/c:'Error';
    disp=String(r);rst=true;
  }
}

// ===================== PAINT =====================
function buildPaint(b){
  b.style.cssText='display:flex;flex-direction:column;height:100%';
  const swatches=['#000000','#808080','#800000','#808000','#008000','#008080','#000080','#800080',
    '#ffffff','#c0c0c0','#ff0000','#ffff00','#00ff00','#00ffff','#0000ff','#ff00ff',
    '#ff8800','#88ff00','#00ff88','#0088ff','#8800ff','#ff0088'];
  b.innerHTML=`<div class="pt-bar">
    <button class="pt-btn active" data-t="brush">‚úèÔ∏è Brush</button>
    <button class="pt-btn" data-t="eraser">üßπ Eraser</button>
    <button class="pt-btn" data-t="line">‚ï± Line</button>
    <button class="pt-btn" data-t="rect">‚ñ≠ Rect</button>
    <button class="pt-btn" data-t="circle">‚óØ Circle</button>
    <button class="pt-btn" data-t="fill">ü™£ Fill</button>
    <div style="width:1px;height:20px;background:#ddd;margin:0 2px"></div>
    <label>Size</label><input type="range" id="ps" min="1" max="30" value="3">
    <div class="pt-colors">${swatches.map(c=>`<div class="pt-color-swatch" style="background:${c}" data-c="${c}"></div>`).join('')}</div>
    <input type="color" id="pc" value="#000000" style="margin-left:4px">
    <div style="flex:1"></div>
    <button class="pt-btn" id="pclear">üóë Clear</button>
  </div>
  <div class="pt-wrap"><canvas id="pcanvas" width="780" height="460"></canvas></div>`;
  const cv=b.querySelector('#pcanvas'),cx=cv.getContext('2d');
  cx.fillStyle='#fff';cx.fillRect(0,0,cv.width,cv.height);
  cx.lineCap='round';cx.lineJoin='round';
  let tool='brush',drawing=false,lx,ly,sx2,sy2,snap;
  const colorInput=b.querySelector('#pc');
  b.querySelectorAll('.pt-color-swatch').forEach(s=>{
    s.onclick=()=>colorInput.value=s.dataset.c;
  });
  b.querySelectorAll('.pt-btn[data-t]').forEach(btn=>{
    btn.onclick=()=>{b.querySelectorAll('.pt-btn[data-t]').forEach(x=>x.classList.remove('active'));btn.classList.add('active');tool=btn.dataset.t;};
  });
  b.querySelector('#pclear').onclick=()=>{cx.fillStyle='#fff';cx.fillRect(0,0,cv.width,cv.height);};

  function floodFill(x,y,fillColor){
    const id=cx.getImageData(0,0,cv.width,cv.height);
    const d=id.data;
    const target=[d[(y*cv.width+x)*4],d[(y*cv.width+x)*4+1],d[(y*cv.width+x)*4+2],d[(y*cv.width+x)*4+3]];
    const fill=hexToRgb(fillColor);
    if(target[0]===fill[0]&&target[1]===fill[1]&&target[2]===fill[2])return;
    const stack=[[x,y]];
    while(stack.length){
      const [cx2,cy2]=stack.pop();
      const idx=(cy2*cv.width+cx2)*4;
      if(cx2<0||cx2>=cv.width||cy2<0||cy2>=cv.height)continue;
      if(d[idx]!==target[0]||d[idx+1]!==target[1]||d[idx+2]!==target[2]||d[idx+3]!==target[3])continue;
      d[idx]=fill[0];d[idx+1]=fill[1];d[idx+2]=fill[2];d[idx+3]=255;
      stack.push([cx2+1,cy2],[cx2-1,cy2],[cx2,cy2+1],[cx2,cy2-1]);
    }
    cx.putImageData(id,0,0);
  }
  function hexToRgb(h){const r=parseInt(h.slice(1,3),16),g=parseInt(h.slice(3,5),16),b2=parseInt(h.slice(5,7),16);return[r,g,b2];}

  cv.onmousedown=e=>{
    drawing=true;const r=cv.getBoundingClientRect();
    lx=sx2=~~(e.clientX-r.left);ly=sy2=~~(e.clientY-r.top);
    if(tool==='fill'){floodFill(sx2,sy2,colorInput.value);drawing=false;return;}
    if('line rect circle'.includes(tool))snap=cx.getImageData(0,0,cv.width,cv.height);
    if('brush eraser'.includes(tool)){cx.beginPath();cx.moveTo(lx,ly);}
  };
  cv.onmousemove=e=>{
    if(!drawing)return;const r=cv.getBoundingClientRect();
    const x=~~(e.clientX-r.left),y=~~(e.clientY-r.top);
    const sz=+b.querySelector('#ps').value,col=colorInput.value;
    if(tool==='brush'){cx.strokeStyle=col;cx.lineWidth=sz;cx.lineTo(x,y);cx.stroke();}
    else if(tool==='eraser'){cx.strokeStyle='#fff';cx.lineWidth=sz*3;cx.lineTo(x,y);cx.stroke();}
    else if(tool==='line'){cx.putImageData(snap,0,0);cx.strokeStyle=col;cx.lineWidth=sz;cx.beginPath();cx.moveTo(sx2,sy2);cx.lineTo(x,y);cx.stroke();}
    else if(tool==='rect'){cx.putImageData(snap,0,0);cx.strokeStyle=col;cx.lineWidth=sz;cx.strokeRect(sx2,sy2,x-sx2,y-sy2);}
    else if(tool==='circle'){cx.putImageData(snap,0,0);cx.strokeStyle=col;cx.lineWidth=sz;
      const rx=Math.abs(x-sx2)/2,ry=Math.abs(y-sy2)/2;
      cx.beginPath();cx.ellipse(sx2+(x-sx2)/2,sy2+(y-sy2)/2,rx,ry,0,0,Math.PI*2);cx.stroke();}
    lx=x;ly=y;
  };
  cv.onmouseup=cv.onmouseleave=()=>{drawing=false;};
}

// ===================== WORD =====================
function buildWord(b){
  b.style.cssText='display:flex;flex-direction:column;height:100%';
  b.innerHTML=`
  <div class="wd-tabs">
    <div class="wd-tab">File</div>
    <div class="wd-tab active">Home</div>
    <div class="wd-tab">Insert</div>
    <div class="wd-tab">Layout</div>
    <div class="wd-tab">Review</div>
    <div class="wd-tab">View</div>
  </div>
  <div class="wd-ribbon">
    <select onchange="document.execCommand('fontName',false,this.value)">
      <option>Calibri</option><option>Arial</option><option>Times New Roman</option>
      <option>Segoe UI</option><option>Georgia</option><option>Courier New</option>
      <option>Verdana</option><option>Comic Sans MS</option><option>Trebuchet MS</option>
    </select>
    <select onchange="document.execCommand('fontSize',false,this.value)">
      <option value="1">8</option><option value="2">10</option><option value="3" selected>12</option>
      <option value="4">14</option><option value="5">18</option><option value="6">24</option><option value="7">36</option>
    </select>
    <div class="sep"></div>
    <button onclick="document.execCommand('bold')" title="Bold" style="font-weight:bold">B</button>
    <button onclick="document.execCommand('italic')" title="Italic" style="font-style:italic">I</button>
    <button onclick="document.execCommand('underline')" title="Underline" style="text-decoration:underline">U</button>
    <button onclick="document.execCommand('strikeThrough')" title="Strikethrough"><s>ab</s></button>
    <div class="sep"></div>
    <input type="color" value="#000000" onchange="document.execCommand('foreColor',false,this.value)" title="Font Color" style="width:24px;height:22px;border:1px solid #ddd;border-radius:3px;cursor:pointer;padding:1px;">
    <input type="color" value="#ffff00" onchange="document.execCommand('hiliteColor',false,this.value)" title="Highlight" style="width:24px;height:22px;border:1px solid #ddd;border-radius:3px;cursor:pointer;padding:1px;">
    <div class="sep"></div>
    <button onclick="document.execCommand('justifyLeft')" title="Left">‚´∑</button>
    <button onclick="document.execCommand('justifyCenter')" title="Center">‚â°</button>
    <button onclick="document.execCommand('justifyRight')" title="Right">‚´∏</button>
    <button onclick="document.execCommand('justifyFull')" title="Justify">‚ò∞</button>
    <div class="sep"></div>
    <button onclick="document.execCommand('insertUnorderedList')" title="Bullets">‚Ä¢ ‚Äî</button>
    <button onclick="document.execCommand('insertOrderedList')" title="Numbers">1. ‚Äî</button>
    <button onclick="document.execCommand('indent')" title="Indent">‚Üí|</button>
    <button onclick="document.execCommand('outdent')" title="Outdent">|‚Üê</button>
  </div>
  <div class="wd-area"><div class="wd-page" contenteditable="true">
    <h2 style="margin-bottom:8px;font-family:Calibri,sans-serif;color:#1a1a1a;">Document Title</h2>
    <p style="font-family:Calibri,sans-serif;">Start typing your document here. Use the ribbon toolbar above to format text ‚Äî change fonts, sizes, apply <b>bold</b>, <i>italic</i>, <u>underline</u>, adjust colors and alignment, and create lists.</p>
    <p style="font-family:Calibri,sans-serif;"><br></p>
    <p style="font-family:Calibri,sans-serif;">This word processor supports rich text editing with multiple formatting options, just like the real thing.</p>
  </div></div>`;
  b.querySelectorAll('.wd-tab').forEach(t=>{
    t.onclick=()=>{b.querySelectorAll('.wd-tab').forEach(x=>x.classList.remove('active'));t.classList.add('active');};
  });
}

// ===================== FILE EXPLORER =====================
function buildExplorer(b){
  b.style.cssText='display:flex;height:100%';
  const fs={
    'This PC':{
      'Desktop':{'New Folder':{},'notes.txt':null,'photo.jpg':null,'shortcuts.lnk':null},
      'Documents':{'Resume.docx':null,'Budget.xlsx':null,'Slides.pptx':null,'Report.pdf':null,'Projects':{},'Work':{}},
      'Downloads':{'setup.exe':null,'image.png':null,'song.mp3':null,'archive.zip':null,'readme.txt':null,'installer.msi':null},
      'Pictures':{'Vacation':{},'Screenshots':{},'wallpaper.jpg':null,'avatar.png':null,'banner.jpg':null},
      'Music':{'playlist.m3u':null,'Albums':{},'Podcasts':{}},
      'Videos':{'recording.mp4':null,'Tutorials':{},'Movies':{}}
    }
  };
  const ficons={'Desktop':'üñ•Ô∏è','Documents':'üìÑ','Downloads':'‚¨áÔ∏è','Pictures':'üñºÔ∏è','Music':'üéµ','Videos':'üé¨','This PC':'üíª'};
  const extIcons={txt:'üìù',docx:'üìò',xlsx:'üìó',pptx:'üìô',pdf:'üìï',exe:'‚öôÔ∏è',msi:'‚öôÔ∏è',png:'üñºÔ∏è',jpg:'üñºÔ∏è',mp3:'üéµ',mp4:'üé¨',zip:'üì¶',m3u:'üéµ',lnk:'üîó'};
  let path=['This PC'];

  function getDir(p){let d=fs;for(const k of p){if(d&&d[k]!==undefined&&d[k]!==null)d=d[k];else return{};}return d||{};}

  function render(){
    const dir=getDir(path);
    b.innerHTML=`<div class="ex-side">
      <div class="ex-si${path.length===1?' active':''}" data-p="root"><span>üíª</span> This PC</div>
      ${Object.keys(fs['This PC']).map(k=>
        `<div class="ex-si${path[1]===k?' active':''}" data-p="${k}" style="padding-left:28px"><span>${ficons[k]||'üìÅ'}</span> ${k}</div>`
      ).join('')}
    </div>
    <div class="ex-main">
      <div class="ex-path">
        ${path.length>1?'<button class="ex-back" id="ex-back">‚Üê </button>':''}
        <input value="${path.join(' ‚Ä∫ ')}" readonly>
      </div>
      <div class="ex-content">
        ${Object.entries(dir).map(([n,v])=>{
          const isF=v!==null&&typeof v==='object';
          const ext=n.split('.').pop().toLowerCase();
          const icon=isF?'üìÅ':(extIcons[ext]||'üìÑ');
          return `<div class="ex-item" data-n="${n}" data-f="${isF}">
            <div class="exi">${icon}</div><span>${n}</span></div>`;
        }).join('')||'<div style="padding:20px;color:#888;font-size:13px;">This folder is empty</div>'}
      </div>
    </div>`;
    b.querySelector('#ex-back')?.addEventListener('click',()=>{if(path.length>1){path.pop();render();}});
    b.querySelectorAll('.ex-si').forEach(s=>{
      s.onclick=()=>{
        if(s.dataset.p==='root')path=['This PC'];
        else path=['This PC',s.dataset.p];
        render();
      };
    });
    b.querySelectorAll('.ex-item').forEach(i=>{
      i.ondblclick=()=>{if(i.dataset.f==='true'){path.push(i.dataset.n);render();}};
      i.onclick=()=>{b.querySelectorAll('.ex-item').forEach(x=>x.classList.remove('sel'));i.classList.add('sel');};
    });
  }
  render();
}

// ===================== CHROME =====================
function buildChrome(b){
  b.style.cssText='display:flex;flex-direction:column;height:100%';
  const chromeSvg=SVG.chrome.replace(/width="[^"]*"/,'width="14"').replace(/height="[^"]*"/,'height="14"');
  b.innerHTML=`<div class="cr-tabs">
    <div class="cr-tab"><svg width="14" height="14" viewBox="0 0 96 96"><circle cx="48" cy="48" r="40" fill="#fff"/><path d="M48 8a40 40 0 0134.64 20H48z" fill="#ea4335"/><path d="M82.64 28A40 40 0 0148 88l17.32-30z" fill="#4285f4"/><path d="M48 88A40 40 0 0113.36 28L30.68 58z" fill="#34a853"/><path d="M13.36 28L48 28 30.68 58z" fill="#fbbc04"/><circle cx="48" cy="48" r="16" fill="#fff"/><circle cx="48" cy="48" r="12" fill="#4285f4"/></svg>New Tab</div>
  </div>
  <div class="cr-bar">
    <button class="cr-nav" id="cr-back">‚Üê</button><button class="cr-nav">‚Üí</button><button class="cr-nav" id="cr-refresh">‚Üª</button>
    <input class="cr-url" value="chrome://newtab" id="curl">
    <button class="cr-nav">‚òÜ</button><button class="cr-nav">‚ãÆ</button>
  </div>
  <div class="cr-body" id="ccont">
    <svg class="cr-logo" viewBox="0 0 96 96"><circle cx="48" cy="48" r="40" fill="#fff"/><path d="M48 8a40 40 0 0134.64 20H48z" fill="#ea4335"/><path d="M82.64 28A40 40 0 0148 88l17.32-30z" fill="#4285f4"/><path d="M48 88A40 40 0 0113.36 28L30.68 58z" fill="#34a853"/><path d="M13.36 28L48 28 30.68 58z" fill="#fbbc04"/><circle cx="48" cy="48" r="16" fill="#fff"/><circle cx="48" cy="48" r="12" fill="#4285f4"/></svg>
    <input class="cr-search" placeholder="Search Google or type a URL" id="csinput">
    <div class="cr-shortcuts">
      <div class="cr-sc"><div class="cr-sc-i">üìß</div><span>Gmail</span></div>
      <div class="cr-sc"><div class="cr-sc-i">‚ñ∂Ô∏è</div><span>YouTube</span></div>
      <div class="cr-sc"><div class="cr-sc-i">üó∫Ô∏è</div><span>Maps</span></div>
      <div class="cr-sc"><div class="cr-sc-i">üì∞</div><span>News</span></div>
      <div class="cr-sc"><div class="cr-sc-i">üõí</div><span>Shopping</span></div>
      <div class="cr-sc"><div class="cr-sc-i">üíæ</div><span>Drive</span></div>
      <div class="cr-sc"><div class="cr-sc-i">üîÑ</div><span>Translate</span></div>
      <div class="cr-sc"><div class="cr-sc-i">üì∑</div><span>Photos</span></div>
    </div>
  </div>`;

  const si=b.querySelector('#csinput'),ui=b.querySelector('#curl'),ct=b.querySelector('#ccont');
  let isNewTab=true;

  function showNewTab(){
    isNewTab=true;ui.value='chrome://newtab';
    ct.style.paddingTop='80px';ct.style.alignItems='center';
    ct.innerHTML=`
      <svg class="cr-logo" viewBox="0 0 96 96"><circle cx="48" cy="48" r="40" fill="#fff"/><path d="M48 8a40 40 0 0134.64 20H48z" fill="#ea4335"/><path d="M82.64 28A40 40 0 0148 88l17.32-30z" fill="#4285f4"/><path d="M48 88A40 40 0 0113.36 28L30.68 58z" fill="#34a853"/><path d="M13.36 28L48 28 30.68 58z" fill="#fbbc04"/><circle cx="48" cy="48" r="16" fill="#fff"/><circle cx="48" cy="48" r="12" fill="#4285f4"/></svg>
      <input class="cr-search" placeholder="Search Google or type a URL" id="csinput2">
      <div class="cr-shortcuts">
        <div class="cr-sc"><div class="cr-sc-i">üìß</div><span>Gmail</span></div>
        <div class="cr-sc"><div class="cr-sc-i">‚ñ∂Ô∏è</div><span>YouTube</span></div>
        <div class="cr-sc"><div class="cr-sc-i">üó∫Ô∏è</div><span>Maps</span></div>
        <div class="cr-sc"><div class="cr-sc-i">üì∞</div><span>News</span></div>
      </div>`;
    const si2=ct.querySelector('#csinput2');
    if(si2)si2.addEventListener('keydown',e=>{if(e.key==='Enter'&&si2.value.trim())doSearch(si2.value.trim());});
  }

  function doSearch(q){
    isNewTab=false;
    ui.value=`https://www.google.com/search?q=${encodeURIComponent(q)}`;
    ct.style.paddingTop='0';ct.style.alignItems='flex-start';
    const count=(Math.random()*5e6+1e5).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,',');
    const time=(Math.random()*0.6+0.1).toFixed(2);
    ct.innerHTML=`<div style="width:100%;max-width:680px;padding:16px 32px;">
      <div style="font-size:26px;margin-bottom:16px;">
        <span style="color:#4285f4">G</span><span style="color:#ea4335">o</span><span style="color:#fbbc04">o</span><span style="color:#4285f4">g</span><span style="color:#34a853">l</span><span style="color:#ea4335">e</span>
      </div>
      <div style="font-size:12px;color:#70757a;margin-bottom:18px;">About ${count} results (${time} seconds)</div>
      ${[
        {t:`${q} - Wikipedia`,u:`en.wikipedia.org ‚Ä∫ wiki ‚Ä∫ ${q.replace(/\s/g,'_')}`,d:`${q} refers to a broad topic encompassing various aspects of technology, science, and culture. This article provides comprehensive information about its history, applications, and significance in modern society.`},
        {t:`Understanding ${q} | Complete Guide 2025`,u:`www.techguide.com ‚Ä∫ articles ‚Ä∫ ${q.toLowerCase().replace(/\s/g,'-')}`,d:`A thorough guide covering everything you need to know about ${q}. Includes tutorials, examples, best practices, and expert recommendations for beginners and professionals alike.`},
        {t:`${q} ‚Äî Latest News & Analysis`,u:`www.reuters.com ‚Ä∫ technology ‚Ä∫ ${q.toLowerCase().replace(/\s/g,'-')}`,d:`Breaking news and in-depth coverage of ${q}. Stay informed about the latest developments, trends, and expert analysis from trusted sources around the world.`},
        {t:`${q} | Official Resources & Downloads`,u:`www.resources.dev ‚Ä∫ ${q.toLowerCase().replace(/\s/g,'-')}`,d:`Free resources, tools, documentation and downloads related to ${q}. Join millions of users who rely on our platform for high-quality information.`},
      ].map(r=>`<div style="margin-bottom:22px;">
        <div style="font-size:12px;color:#202124;margin-bottom:2px;">${r.u}</div>
        <a style="font-size:18px;color:#1a0dab;cursor:pointer;display:block;margin-bottom:4px;line-height:1.3;text-decoration:none;" onmouseover="this.style.textDecoration='underline'" onmouseout="this.style.textDecoration='none'">${r.t}</a>
        <div style="font-size:13px;color:#4d5156;line-height:1.45;">${r.d}</div>
      </div>`).join('')}
    </div>`;
  }

  b.querySelector('#cr-back').onclick=()=>showNewTab();
  b.querySelector('#cr-refresh').onclick=()=>{if(!isNewTab){const q=ui.value.split('q=')[1];if(q)doSearch(decodeURIComponent(q));}};

  si.addEventListener('keydown',e=>{if(e.key==='Enter'&&si.value.trim())doSearch(si.value.trim());});
  ui.addEventListener('keydown',e=>{
    if(e.key==='Enter'){
      const v=ui.value.trim();
      if(v==='chrome://newtab')showNewTab();
      else if(!v.includes('.')&&!v.startsWith('chrome://'))doSearch(v);
    }
  });
}
</script>
</body>
</html>
