<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaotic Gravitational System: Sun, Earth, Jupiter & Spacecraft</title>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #111;
            color: #fff;
            font-family: 'Courier New', monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden;
        }

        .header {
            text-align: center;
            padding: 20px;
            width: 100%;
            background: linear-gradient(90deg, #0a0a2a, #1a1a3a);
            border-bottom: 3px solid #00aaff;
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #00aaff;
            text-shadow: 0 0 10px rgba(0, 170, 255, 0.5);
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1rem;
            color: #aaddff;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.5;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            width: 100%;
            max-width: 1200px;
        }

        #canvas-container {
            border: 3px solid #00aaff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 30px rgba(0, 170, 255, 0.3);
            margin: 20px 0;
            background-color: #1a1a2e;
        }

        .controls {
            background: rgba(20, 20, 40, 0.9);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00aaff;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
        }

        .control-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
            justify-content: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(30, 30, 60, 0.7);
            padding: 10px;
            border-radius: 8px;
            min-width: 150px;
        }

        .control-label {
            font-size: 0.9rem;
            color: #88ccff;
            margin-bottom: 5px;
            text-align: center;
        }

        .control-value {
            font-size: 1.2rem;
            color: #00ffaa;
            font-weight: bold;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #00aaff, #0088cc);
            border: none;
            border-radius: 6px;
            color: white;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0, 170, 255, 0.3);
        }

        .btn:hover {
            background: linear-gradient(135deg, #00ccff, #00aaff);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 170, 255, 0.5);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.reset {
            background: linear-gradient(135deg, #ff5555, #cc0000);
        }

        .btn.reset:hover {
            background: linear-gradient(135deg, #ff7777, #ff5555);
        }

        .info-panel {
            background: rgba(10, 10, 30, 0.9);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #00ffaa;
            margin-top: 20px;
            width: 100%;
            max-width: 800px;
        }

        .info-title {
            color: #00ffaa;
            font-size: 1.2rem;
            margin-bottom: 10px;
            text-align: center;
        }

        .info-text {
            color: #aaddff;
            font-size: 0.95rem;
            line-height: 1.6;
            text-align: center;
        }

        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        .legend-text {
            color: #ccc;
            font-size: 0.9rem;
        }

        .footer {
            text-align: center;
            padding: 15px;
            color: #6688aa;
            font-size: 0.9rem;
            margin-top: 20px;
            border-top: 1px solid #334466;
            width: 100%;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 1.8rem;
            }
            
            .control-row {
                flex-direction: column;
                align-items: center;
            }
            
            .control-group {
                width: 100%;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="title">Chaotic Gravitational System</div>
        <div class="subtitle">Sun, Earth, Jupiter & Spacecraft Simulation • Newtonian Gravity • Persistent Orbital Trails</div>
    </div>

    <div class="container">
        <div id="canvas-container"></div>

        <div class="controls">
            <div class="control-row">
                <div class="control-group">
                    <div class="control-label">Simulation Time</div>
                    <div class="control-value" id="timeDisplay">00:00</div>
                </div>
                <div class="control-group">
                    <div class="control-label">Spacecraft Status</div>
                    <div class="control-value" id="craftStatus">DOCKED</div>
                </div>
                <div class="control-group">
                    <div class="control-label">Total Orbits</div>
                    <div class="control-value" id="orbitCount">0</div>
                </div>
                <div class="control-group">
                    <div class="control-label">Chaos Level</div>
                    <div class="control-value" id="chaosLevel">HIGH</div>
                </div>
            </div>

            <div class="buttons">
                <button class="btn" id="launchBtn">LAUNCH SPACECRAFT</button>
                <button class="btn" id="resetBtn">RESET SIMULATION</button>
                <button class="btn" id="speedBtn">SPEED: 1x</button>
            </div>
        </div>

        <div class="info-panel">
            <div class="info-title">PHYSICS SIMULATION INFO</div>
            <div class="info-text">
                This simulation uses Newtonian gravity with chaotic initial conditions. The planetary orbits are intentionally non-stable but bounded.
                The spacecraft will complete a loop around the Sun before traveling to Jupiter. All bodies remain within the gravitational system.
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #FFD700;"></div>
                <div class="legend-text">Sun (Mass: 1000)</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #1E90FF;"></div>
                <div class="legend-text">Earth (Mass: 10)</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #FF6B6B;"></div>
                <div class="legend-text">Jupiter (Mass: 100)</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #00FFAA;"></div>
                <div class="legend-text">Spacecraft (Mass: 0.1)</div>
            </div>
        </div>

        <div class="footer">
            p5.js Gravitational Simulation • Newtonian Physics • Chaotic Orbits • Persistent Trails
        </div>
    </div>

    <script>
        // Gravitational Simulation
        let bodies = [];
        let trails = { sun: [], earth: [], jupiter: [], craft: [] };
        let G = 0.5; // Gravitational constant (adjusted for visual appeal)
        let time = 0;
        let simulationSpeed = 1;
        let spacecraftLaunched = false;
        let spacecraftStage = 0; // 0: docked, 1: departing Earth, 2: orbiting Sun, 3: traveling to Jupiter
        let launchTime = 0;
        let orbitsCompleted = 0;
        
        // Colors for bodies
        const colors = {
            sun: [255, 215, 0],     // Gold
            earth: [30, 144, 255],  // Dodger Blue
            jupiter: [255, 107, 107], // Coral Red
            craft: [0, 255, 170],   // Cyan-Green
            trailSun: [255, 215, 0, 50],
            trailEarth: [30, 144, 255, 40],
            trailJupiter: [255, 107, 107, 40],
            trailCraft: [0, 255, 170, 60]
        };
        
        // Body class representing celestial bodies and spacecraft
        class Body {
            constructor(name, mass, x, y, vx, vy, radius, color) {
                this.name = name;
                this.mass = mass;
                this.position = createVector(x, y);
                this.velocity = createVector(vx, vy);
                this.acceleration = createVector(0, 0);
                this.radius = radius;
                this.color = color;
                this.trail = [];
                this.maxTrailLength = 1000;
                this.prevPos = this.position.copy();
            }
            
            applyForce(force) {
                // F = ma, so a = F/m
                let f = force.copy();
                f.div(this.mass);
                this.acceleration.add(f);
            }
            
            update() {
                // Update velocity and position using Euler integration
                this.velocity.add(this.acceleration);
                this.position.add(this.velocity);
                
                // Store trail point
                this.trail.push(this.position.copy());
                if (this.trail.length > this.maxTrailLength) {
                    this.trail.shift();
                }
                
                // Reset acceleration
                this.acceleration.mult(0);
            }
            
            draw() {
                // Draw the body
                noStroke();
                fill(this.color);
                ellipse(this.position.x, this.position.y, this.radius * 2, this.radius * 2);
                
                // Draw trail
                this.drawTrail();
            }
            
            drawTrail() {
                // Draw persistent trail
                if (this.trail.length < 2) return;
                
                strokeWeight(1);
                for (let i = 1; i < this.trail.length; i++) {
                    // Fade trail based on age
                    let alpha = map(i, 0, this.trail.length, 30, 255);
                    
                    // Set color based on body type
                    if (this.name === 'sun') {
                        stroke(colors.trailSun[0], colors.trailSun[1], colors.trailSun[2], alpha);
                    } else if (this.name === 'earth') {
                        stroke(colors.trailEarth[0], colors.trailEarth[1], colors.trailEarth[2], alpha);
                    } else if (this.name === 'jupiter') {
                        stroke(colors.trailJupiter[0], colors.trailJupiter[1], colors.trailJupiter[2], alpha);
                    } else if (this.name === 'craft') {
                        stroke(colors.trailCraft[0], colors.trailCraft[1], colors.trailCraft[2], alpha);
                    }
                    
                    line(this.trail[i-1].x, this.trail[i-1].y, this.trail[i].x, this.trail[i].y);
                }
            }
            
            // Calculate gravitational force from another body
            attract(other) {
                let force = p5.Vector.sub(this.position, other.position);
                let distance = force.mag();
                
                // Constrain distance to avoid extreme forces
                distance = constrain(distance, 5, width);
                
                let strength = (G * this.mass * other.mass) / (distance * distance);
                force.setMag(strength);
                
                return force;
            }
        }

        function setup() {
            // Create canvas with background color 220 as specified
            let canvas = createCanvas(800, 800);
            canvas.parent('canvas-container');
            background(220);
            
            // Initialize bodies with chaotic but bounded initial conditions
            // Sun at center
            let sun = new Body('sun', 1000, width/2, height/2, 0, 0, 20, colors.sun);
            
            // Earth - positioned with some initial velocity for chaotic orbit
            let earthAngle = random(TWO_PI);
            let earthDistance = random(150, 250);
            let earthX = width/2 + cos(earthAngle) * earthDistance;
            let earthY = height/2 + sin(earthAngle) * earthDistance;
            
            // Tangential velocity for orbit with some random component for chaos
            let earthSpeed = random(1.5, 2.5);
            let earthVx = -sin(earthAngle) * earthSpeed;
            let earthVy = cos(earthAngle) * earthSpeed;
            
            let earth = new Body('earth', 10, earthX, earthY, earthVx, earthVy, 8, colors.earth);
            
            // Jupiter - positioned further out with different orbital characteristics
            let jupiterAngle = random(TWO_PI);
            let jupiterDistance = random(300, 400);
            let jupiterX = width/2 + cos(jupiterAngle) * jupiterDistance;
            let jupiterY = height/2 + sin(jupiterAngle) * jupiterDistance;
            
            // Jupiter moves slower due to being further out, plus some chaos
            let jupiterSpeed = random(0.8, 1.2);
            let jupiterVx = -sin(jupiterAngle) * jupiterSpeed;
            let jupiterVy = cos(jupiterAngle) * jupiterSpeed;
            
            let jupiter = new Body('jupiter', 100, jupiterX, jupiterY, jupiterVx, jupiterVy, 15, colors.jupiter);
            
            // Spacecraft - starts docked to Earth
            let craft = new Body('craft', 0.1, earthX, earthY, earthVx, earthVy, 3, colors.craft);
            
            // Add all bodies to the array
            bodies = [sun, earth, jupiter, craft];
            
            // Initialize UI
            updateUI();
        }

        function draw() {
            // Clear with background color 220 with slight transparency for trail persistence
            background(220, 220, 220, 10);
            
            // Update simulation time
            time += 0.0167 * simulationSpeed; // Assuming 60 FPS
            
            // Update UI time display
            updateTimeDisplay();
            
            // Calculate gravitational forces between all bodies
            for (let i = 0; i < bodies.length; i++) {
                for (let j = 0; j < bodies.length; j++) {
                    if (i !== j) {
                        let force = bodies[j].attract(bodies[i]);
                        bodies[i].applyForce(force);
                    }
                }
            }
            
            // Special handling for spacecraft
            let craft = bodies[3];
            let earth = bodies[1];
            let sun = bodies[0];
            let jupiter = bodies[2];
            
            if (!spacecraftLaunched) {
                // Spacecraft is docked to Earth
                craft.position = earth.position.copy();
                craft.velocity = earth.velocity.copy();
                craftStage = 0;
                document.getElementById('craftStatus').textContent = 'DOCKED';
                document.getElementById('craftStatus').style.color = '#00aaff';
            } else {
                // Spacecraft has been launched
                handleSpacecraftMission(craft, earth, sun, jupiter);
            }
            
            // Update all bodies
            for (let body of bodies) {
                body.update();
                
                // Keep bodies within bounds (gentle boundary force)
                applyBoundaryForce(body);
            }
            
            // Check for orbit completions (when Earth completes a loop around Sun)
            checkOrbits();
            
            // Draw all bodies (with trails)
            for (let body of bodies) {
                body.draw();
            }
            
            // Draw additional visual elements
            drawOrbitIndicators();
            drawInfoText();
        }
        
        function handleSpacecraftMission(craft, earth, sun, jupiter) {
            let timeSinceLaunch = time - launchTime;
            
            // Stage 1: Departing Earth (first few seconds)
            if (timeSinceLaunch < 2) {
                craftStage = 1;
                document.getElementById('craftStatus').textContent = 'DEPARTING EARTH';
                document.getElementById('craftStatus').style.color = '#ffaa00';
                
                // Apply a thrust away from Earth
                let thrustDirection = p5.Vector.sub(craft.position, earth.position);
                thrustDirection.normalize();
                thrustDirection.mult(0.05 * simulationSpeed);
                craft.applyForce(thrustDirection);
            }
            // Stage 2: Orbiting Sun (complete at least one orbit)
            else if (timeSinceLaunch < 30 || orbitsCompleted < 1) {
                craftStage = 2;
                document.getElementById('craftStatus').textContent = 'ORBITING SUN';
                document.getElementById('craftStatus').style.color = '#ffaa00';
                
                // Calculate if craft has completed an orbit around Sun
                let angleToSun = atan2(craft.position.y - sun.position.y, craft.position.x - sun.position.x);
                let prevAngleToSun = atan2(craft.prevPos.y - sun.position.y, craft.prevPos.x - sun.position.x);
                
                // Check if we've crossed the 0/2π boundary
                if (abs(angleToSun - prevAngleToSun) > PI) {
                    orbitsCompleted++;
                    document.getElementById('orbitCount').textContent = orbitsCompleted;
                }
                
                // Occasionally apply small thrust to maintain orbit
                if (frameCount % 60 < 2) {
                    let tangentialDirection = createVector(-(craft.position.y - sun.position.y), craft.position.x - sun.position.x);
                    tangentialDirection.normalize();
                    tangentialDirection.mult(0.01 * simulationSpeed);
                    craft.applyForce(tangentialDirection);
                }
            }
            // Stage 3: Traveling to Jupiter
            else {
                craftStage = 3;
                document.getElementById('craftStatus').textContent = 'TRAVELING TO JUPITER';
                document.getElementById('craftStatus').style.color = '#00ffaa';
                
                // Calculate direction to Jupiter
                let toJupiter = p5.Vector.sub(jupiter.position, craft.position);
                let distanceToJupiter = toJupiter.mag();
                
                // Apply thrust toward Jupiter (with some lead)
                toJupiter.normalize();
                
                // Add some tangential component for efficient transfer orbit
                let tangential = createVector(-toJupiter.y, toJupiter.x);
                tangential.mult(0.3);
                
                let thrustVector = p5.Vector.add(toJupiter, tangential);
                thrustVector.normalize();
                thrustVector.mult(0.02 * simulationSpeed);
                
                craft.applyForce(thrustVector);
                
                // If very close to Jupiter, we've arrived
                if (distanceToJupiter < 50) {
                    document.getElementById('craftStatus').textContent = 'ARRIVED AT JUPITER';
                    document.getElementById('craftStatus').style.color = '#00ffaa';
                }
            }
            
            // Store previous position for orbit calculations
            craft.prevPos = craft.position.copy();
        }
        
        function applyBoundaryForce(body) {
            // Gentle force to keep bodies within canvas bounds
            let boundaryForce = createVector(0, 0);
            let margin = 50;
            
            if (body.position.x < margin) {
                boundaryForce.x = 0.1;
            } else if (body.position.x > width - margin) {
                boundaryForce.x = -0.1;
            }
            
            if (body.position.y < margin) {
                boundaryForce.y = 0.1;
            } else if (body.position.y > height - margin) {
                boundaryForce.y = -0.1;
            }
            
            body.applyForce(boundaryForce);
        }
        
        function checkOrbits() {
            // Simple orbit counter for Earth around Sun
            let earth = bodies[1];
            let sun = bodies[0];
            
            static let lastAngle = null;
            static let rotations = 0;
            
            let currentAngle = atan2(earth.position.y - sun.position.y, earth.position.x - sun.position.x);
            
            if (lastAngle !== null) {
                // Check for complete revolution (crossing from -π to π or vice versa)
                if (abs(lastAngle - currentAngle) > PI) {
                    rotations++;
                    document.getElementById('orbitCount').textContent = rotations;
                }
            }
            
            lastAngle = currentAngle;
        }
        
        function drawOrbitIndicators() {
            // Draw orbit paths
            noFill();
            stroke(255, 255, 255, 30);
            strokeWeight(1);
            
            // Earth's approximate orbit
            ellipse(width/2, height/2, 400, 400);
            
            // Jupiter's approximate orbit
            ellipse(width/2, height/2, 700, 700);
            
            // Draw distance indicators
            stroke(255, 255, 255, 50);
            strokeWeight(0.5);
            
            // Lines from Sun to planets
            line(bodies[0].position.x, bodies[0].position.y, bodies[1].position.x, bodies[1].position.y);
            line(bodies[0].position.x, bodies[0].position.y, bodies[2].position.x, bodies[2].position.y);
            
            // If spacecraft is launched, draw its trajectory indicator
            if (spacecraftLaunched) {
                stroke(0, 255, 170, 80);
                strokeWeight(1);
                let craft = bodies[3];
                let sun = bodies[0];
                
                // Draw line from Sun to spacecraft
                line(sun.position.x, sun.position.y, craft.position.x, craft.position.y);
                
                // Draw predicted path to Jupiter in stage 3
                if (craftStage === 3) {
                    let jupiter = bodies[2];
                    let predictedPath = p5.Vector.sub(jupiter.position, craft.position);
                    predictedPath.mult(0.5);
                    
                    stroke(0, 255, 170, 40);
                    strokeWeight(2);
                    line(craft.position.x, craft.position.y, 
                         craft.position.x + predictedPath.x, craft.position.y + predictedPath.y);
                }
            }
        }
        
        function drawInfoText() {
            // Draw simulation info on canvas
            fill(255, 255, 255, 200);
            noStroke();
            textSize(14);
            textAlign(LEFT, TOP);
            
            // Display current time
            text(`Time: ${nf(time, 0, 1)}s`, 20, 20);
            
            // Display gravitational constant
            text(`Gravity Constant: ${G}`, 20, 45);
            
            // Display spacecraft stage
            let stageText = "Spacecraft: ";
            if (!spacecraftLaunched) {
                stageText += "Docked to Earth";
            } else if (craftStage === 1) {
                stageText += "Departing Earth";
            } else if (craftStage === 2) {
                stageText += "Orbiting Sun";
            } else if (craftStage === 3) {
                stageText += "Traveling to Jupiter";
            }
            text(stageText, 20, 70);
            
            // Display velocities
            textAlign(RIGHT, TOP);
            text(`Earth Velocity: ${nf(bodies[1].velocity.mag(), 0, 2)}`, width - 20, 20);
            text(`Jupiter Velocity: ${nf(bodies[2].velocity.mag(), 0, 2)}`, width - 20, 45);
            text(`Craft Velocity: ${nf(bodies[3].velocity.mag(), 0, 2)}`, width - 20, 70);
            
            // Draw center of mass indicator
            let com = calculateCenterOfMass();
            fill(255, 255, 255, 100);
            ellipse(com.x, com.y, 10, 10);
            fill(255, 255, 255, 200);
            textSize(12);
            text("Center of Mass", com.x + 10, com.y - 5);
        }
        
        function calculateCenterOfMass() {
            let totalMass = 0;
            let comX = 0;
            let comY = 0;
            
            for (let body of bodies) {
                totalMass += body.mass;
                comX += body.position.x * body.mass;
                comY += body.position.y * body.mass;
            }
            
            comX /= totalMass;
            comY /= totalMass;
            
            return createVector(comX, comY);
        }
        
        function updateTimeDisplay() {
            let minutes = floor(time / 60);
            let seconds = floor(time % 60);
            let timeString = nf(minutes, 2) + ":" + nf(seconds, 2);
            document.getElementById('timeDisplay').textContent = timeString;
        }
        
        function updateUI() {
            // Update chaos level based on orbital eccentricities
            let earth = bodies[1];
            let sun = bodies[0];
            let distance = dist(earth.position.x, earth.position.y, sun.position.x, sun.position.y);
            
            // Simple chaos indicator based on distance variance
            static let lastDistance = distance;
            let variance = abs(distance - lastDistance);
            
            if (variance > 20) {
                document.getElementById('chaosLevel').textContent = "HIGH";
                document.getElementById('chaosLevel').style.color = "#ff5555";
            } else if (variance > 10) {
                document.getElementById('chaosLevel').textContent = "MEDIUM";
                document.getElementById('chaosLevel').style.color = "#ffaa00";
            } else {
                document.getElementById('chaosLevel').textContent = "LOW";
                document.getElementById('chaosLevel').style.color = "#00ffaa";
            }
            
            lastDistance = distance;
        }
        
        function launchSpacecraft() {
            if (!spacecraftLaunched) {
                spacecraftLaunched = true;
                launchTime = time;
                
                // Give the spacecraft an initial boost
                let craft = bodies[3];
                let earth = bodies[1];
                
                // Calculate direction perpendicular to Earth-Sun line for orbit insertion
                let toSun = p5.Vector.sub(bodies[0].position, earth.position);
                toSun.normalize();
                let thrustDirection = createVector(-toSun.y, toSun.x); // Perpendicular
                
                // Apply initial thrust
                thrustDirection.mult(2);
                craft.velocity.add(thrustDirection);
                
                // Update UI
                document.getElementById('launchBtn').textContent = "SPACECRAFT LAUNCHED";
                document.getElementById('launchBtn').disabled = true;
                document.getElementById('launchBtn').style.opacity = "0.7";
            }
        }
        
        function resetSimulation() {
            // Reset simulation to initial state
            spacecraftLaunched = false;
            spacecraftStage = 0;
            time = 0;
            orbitsCompleted = 0;
            launchTime = 0;
            
            // Reset UI
            document.getElementById('launchBtn').textContent = "LAUNCH SPACECRAFT";
            document.getElementById('launchBtn').disabled = false;
            document.getElementById('launchBtn').style.opacity = "1";
            document.getElementById('craftStatus').textContent = "DOCKED";
            document.getElementById('craftStatus').style.color = "#00aaff";
            document.getElementById('orbitCount').textContent = "0";
            
            // Reinitialize with new random chaotic conditions
            setup();
        }
        
        function toggleSpeed() {
            // Cycle through simulation speeds
            if (simulationSpeed === 1) {
                simulationSpeed = 2;
                document.getElementById('speedBtn').textContent = "SPEED: 2x";
            } else if (simulationSpeed === 2) {
                simulationSpeed = 5;
                document.getElementById('speedBtn').textContent = "SPEED: 5x";
            } else if (simulationSpeed === 5) {
                simulationSpeed = 10;
                document.getElementById('speedBtn').textContent = "SPEED: 10x";
            } else {
                simulationSpeed = 1;
                document.getElementById('speedBtn').textContent = "SPEED: 1x";
            }
        }
        
        // Event listeners for UI buttons
        document.getElementById('launchBtn').addEventListener('click', launchSpacecraft);
        document.getElementById('resetBtn').addEventListener('click', resetSimulation);
        document.getElementById('speedBtn').addEventListener('click', toggleSpeed);
        
        // Keyboard controls
        function keyPressed() {
            if (key === ' ' || key === 'l' || key === 'L') {
                launchSpacecraft();
                return false; // Prevent default behavior
            } else if (key === 'r' || key === 'R') {
                resetSimulation();
                return false;
            } else if (key === 's' || key === 'S') {
                toggleSpeed();
                return false;
            }
        }
    </script>
</body>
</html>